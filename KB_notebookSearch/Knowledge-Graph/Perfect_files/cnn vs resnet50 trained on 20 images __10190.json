{"name": "cnn vs resnet50 trained on 20 images ", "full_name": " h1 Comparison of CNN vs ResNet for small data sets h3 Introduction h3 Approach h3 Main findings h3 Context h3 Contents h1 Step 1 Importing Essential Libraries h1 Step 2 Making Dictionary of images and labels h1 Step 3 Reading Processing data h1 Step 4 Data Cleaning h1 Step 5 EDA h1 Step 6 Loading and resizing of images h2 Reduce to 20 images per class h1 Step 7 Label Encoding h1 Step 8 Data Augmentation h4 NOTE h1 Step 9 Model Building h2 CNN on 20 images per class h2 Fine tune ResNet50 on 20 images per class h1 Conclusion ", "stargazers_count": 0, "forks_count": 0, "description": "Consensus For typical benign cases without histopathology or followup biologists provide an expert consensus rating of authors PT and HK. Lesions with this type of groundtruth were usually photographed for educational reasons and did not needfurther follow up or biopsy for confirmation. From work seen in other kernels https www. After that we made some new columns which is easily understood for later reference such as we have made column path which contains the image_id cell_type which contains the short name of lesion type and at last we have made the categorical column cell_type_idx in which we have categorize the lesion type in to codes from 0 to 6 Step 4 Data CleaningIn this step we check for Missing values and datatype of each field As it is evident from the above that only age has null values which is 57 so we will fill the null values by their mean. zip into one dictionary This dictionary is useful for displaying more human friendly labels later on Creating New Columns for better readability Now lets see the sample of tile_df to look on newly made columns returns an array with T F for EXTRA occurences of dates returns an array with T F for EXTRA occurences of dates record non duplicate indices slice df by indicies check for duplicate image_ids order by diagnosis look at the existing abbreviations and choose two grab 20 images from 2 classes for the training set concatonate them grab 200 images from 2 classes for the test set concatonate them Checking the image size distribution split x and y columns Perform one hot encoding on the labels With data augmentation to prevent overfitting set input mean to 0 over the dataset set each sample mean to 0 divide inputs by std of the dataset divide each input by its std apply ZCA whitening randomly rotate images in the range degrees 0 to 180 Randomly zoom image randomly shift images horizontally fraction of total width randomly shift images vertically fraction of total height randomly flip images randomly flip images Set the CNN model my CNN architechture is In Conv2D relu 2 MaxPool2D Dropout 2 Flatten Dense Dropout Out Define the optimizer Compile the model Set a learning rate annealer Fit the model Say not to train first layer ResNet model. This the HAM10000 Human Against Machine with 10000 training images dataset. However the deep pre trained network ResNet50 achieves 70 accuracy using only 20 images per class. com keras resnet50 a pre trained deep neural network which can be altered for different use cases. Fine tune ResNet50 on 20 images per classHere we can see that the deep pre trained network ResNet50 achieves 70 accuracy using only 20 images. Plotting the distribution of localization field It seems back lower extremity trunk and upper extremity are heavily compromised regions of skin cancer Now check the distribution of AgeIt seems that there are larger instances of patients having age from 30 to 60Lets see the distribution of males and femalesNow lets visualize agewise distribution of skin cancer typesIt seems that skin cancer types 0 1 3 and 5 which are Melanocytic nevi dermatofibroma Basal cell carcinoma and Vascular lesions are not much prevalant below the age of 20 years Sexwise distribution of skin cancer type Step 6 Loading and resizing of imagesIn this step images will be loaded into the column named image from the image path from the image folder. Actinic keratoses 6. zip Step 3 Reading Processing dataIn this step we have read the csv by joining the path of image folder which is the base folder where all the images are placed named base_skin_dir. com kmader skin cancer mnist ham10000 kernels we know that training with 8 000 images allows the CNN to achieve 77 accuracy https www. Some popular augmentations people use are grayscales horizontal flips vertical flips random crops color jitters translations rotations and much more. used for converting labels to one hot encoding convert to one hot encoding 1. Function to plot model s validation loss and validation accuracy summarize history for accuracy summarize history for loss Merging images from both folders HAM10000_images_part1. Comparison of CNN vs. This demonstrates the power of transfer learning as well as the possibility for similarly difficult problems to be solved sufficiently with relatively small datasets. Main findings We can see that when trained on only 20 images per class the relatively shallow CNN cannot perform better than random guessing 50 probability of accuracy when guessing between 2 classes. We need to encode these labels to one hot vectors Step 8 Data AugmentationIt is the optional step. We also resize the images as the original dimension of images are 450 x 600 x3 which TensorFlow can t handle so that s why we resize it into 100 x 75. In order to avoid overfitting problem we need to expand artificially our HAM 10000 dataset. Context Skin cancer is the most common human malignancy is primarily diagnosed visually beginning with an initial clinical screening and followed potentially by dermoscopic analysis a biopsy and histopathological examination. As this step resize all the 10015 images dimensions into 100x 75 so be patient it will take some time. 5 years biologists accepted this as evidence of biologic benignity. However the deep pre trained network ResNet50 achieves 70 accuracy using only 20 images per class. Basal cell carcinoma 5. Step 9 Model Building CNN on 20 images per class http Here we can see that the relatively shallow CNN cannot perform better than chance 50 probability when guessing between 2 classes. This is a 40 improvement from random guessing which is quite impressive given the very small training set. Now lets check the presence of null values again Step 5 EDAIn this we will explore different features of the dataset their distrubtions and actual countsPlot to see distribution of 7 different classes of cell typeIts seems from the above plot that in this dataset cell type Melanecytic nevi has very large number of instances in comparison to other cell typesPlotting of Technical Validation field ground truth which is dx_type to see the distribution of its 4 categories which are listed below 1. It is already trained compile model fit model. This benchmark dataset can be used for machine learning and for comparisons with human experts. png HAM10000 contains 7 different classes of skin cancer and those used in this experiment are in bold 1. Therefore it can be helpful to look at previous work on a similar problem that is solved well by a deep neural network and reduce the training set to see how well it does. Can we achieve decent accuracy with fewer images The goal of this exploration is to get a sense of how many images are needed for difficult problems while utilizing the power of transfer learning. Confocal Reflectance confocal microscopy is an in vivo imaging technique with a resolution at near cellular level and some facial benign with a grey world assumption of all training set images in Lab color space beforeand after manual histogram changes. It consists of 10015 dermatoscopicimages which are released as a training set for academic machine learning purposes and are publiclyavailable through the ISIC archive. For the data augmentation I chose to Randomly rotate some training images by 10 degrees Randomly Zoom by 10 some training images Randomly shift images horizontally by 10 of the width Randomly shift images vertically by 10 of the height Once our model is ready we fit the training dataset. By applying just a couple of these transformations to our training data we can easily double or triple the number of training examples and create a very robust model. Approach In this kernel I will narrow the problem to detect 2 different classes of skin cancer using only 20 images per class for training. For example if you are trying to classify black versus white images you would only need a few images but if you want to discriminate between nuanced images with a lot of background noise you may need thousands of images per class. Benign keratosis like lesions 4. zip and HAM10000_images_part2. Only nevi but no other benign diagnoses were labeled with this type of ground truth because dermatologists usually do not monitor dermatofibromas seborrheic keratoses or vascular lesions. As we can see image column has been added in its color format code Reduce to 20 images per classLook at some image samples Step 7 Label EncodingLabels are 7 different classes of skin cancer types from 0 to 6. com sid321axn step wise approach cnn model 77 0344 accuracy notebook and ResNet50 achieves 98 accuracy https www. We will augment the data in real time during model training using datagen. Data sample https i. The idea is to alter the training data with small transformations to reproduce the variations Approaches that alter the training data in ways that change the array representation while keeping the label the same are known as data augmentation techniques. Histopathology Histo Histopathologic diagnoses of excised lesions have beenperformed by specialized dermatopathologists. com ingbiodanielh skin cancer classification with resnet 50 fastai notebook. ConclusionWe can see that when trained on only 20 images per class the relatively shallow CNN cannot perform better than random guessing 50 probability of accuracy when guessing between 2 classes. ResNet50 https www. They applied the consensus label only if both authors independently gave the same unequivocal benign diagnosis. The problem we examine here has been solved with 90 classification accuracy when the model was trained on 8 000 images. I will compare two methods to see how they fare on the small dataset a Convolution Neural Network CNN vs. Dermatofibroma Contents In this kernel you will find the following steps Step 1 Importing Essential Libraries Step 2 Making Dictionary of images and labels Step 3 Reading and Processing Data Step 4 Data Cleaning Step 5 Exploratory data analysis EDA Step 6 Loading Resizing of images Step 7 Label Encoding Step 8 Data Augmentation Step 9 Model Buidling Step 1 Importing Essential Libraries Step 2 Making Dictionary of images and labelsIn this step I have made the image path dictionary by joining the folder path from base directory base_skin_dir and merge the images in jpg format from both the folders HAM10000_images_part1. Follow up If nevi monitored by digital dermatoscopy did not show any changes during 3 follow up visits or 1. ResNet for small data sets IntroductionThe number of images needed to train deep neural network is dependent on many factors one being the difficulty of the problem at hand. We can make your existing dataset even larger. This demonstrates the power of transfer learning as well as the possiibility for similarly difficult problems to be solved well with relatively small datasets. NOTE The augmentation object is now instantiated and fit to the data. Automated classification of skin lesions using images is a challenging task owing to the fine grained variability in the appearance of skin lesions. ", "id": "rchesak/cnn-vs-resnet50-trained-on-20-images", "size": "10190", "language": "python", "html_url": "https://www.kaggle.com/code/rchesak/cnn-vs-resnet50-trained-on-20-images", "git_url": "https://www.kaggle.com/code/rchesak/cnn-vs-resnet50-trained-on-20-images", "script": "keras.layers keras.models train_test_split keras confusion_matrix tensorflow.python.keras.layers label_binarize keras.utils.np_utils Image numpy keras.preprocessing.image seaborn Adam Dropout ResNet50 ImageDataGenerator remove_dups BatchNormalization Dense glob backend as K GlobalAveragePooling2D keras.layers.normalization keras.callbacks MaxPool2D tensorflow.python.keras.applications keras.optimizers ReduceLROnPlateau matplotlib.pyplot Sequential backend PIL tensorflow.python.keras.models sklearn.model_selection pandas plot_model_history Conv2D to_categorical # convert to one-hot-encoding to_categorical # used for converting labels to one-hot-encoding sklearn.metrics Flatten sklearn.preprocessing ", "entities": "(('dermatologists', 'dermatofibromas seborrheic usually keratoses'), 'label') (('Function', 'HAM10000_images_part1'), 'summarize') (('benchmark dataset', 'human experts'), 'use') (('Label Step 7 EncodingLabels', '6'), 'add') (('so we', 'mean'), 'make') (('We', 'datagen'), 'augment') (('Lesions', 'needfurther confirmation'), 'photograph') (('cnn accuracy step wise 77 0344 notebook', 'accuracy https 98 www'), 'com') (('years 5 biologists', 'biologic benignity'), 'accept') (('we', 'very robust model'), 'double') (('step images', 'image folder'), 'seem') (('how many images', 'transfer learning'), 'achieve') (('we', 'training dataset'), 'choose') (('relatively shallow CNN', 'when between 2 classes'), 'CNN') (('which', 'ISIC archive'), 'consist') (('that', 'data augmentation techniques'), 'be') (('augmentation object', 'now data'), 'NOTE') (('Automated classification', 'skin lesions'), 'be') (('We', 'one hot vectors'), 'need') (('which', 'training quite very small set'), 'be') (('com keras trained deep neural which', 'use different cases'), 'resnet50') (('CNN architechture', 'first layer'), 'zip') (('most common human malignancy', 'dermoscopic potentially analysis'), 'be') (('how they', 'small dataset'), 'compare') (('how well it', 'training'), 'be') (('HAM10000', 'bold'), 'png') (('when model', '8 000 images'), 'solve') (('network deep pre trained ResNet50', 'only 20 images'), 'tune') (('image path', 'HAM10000_images_part1'), 'Contents') (('grayscales horizontal vertical flips', 'crops color jitters translations rotations'), 'be') (('base where images', 'image folder'), 'step') (('This', 'sufficiently relatively small datasets'), 'demonstrate') (('CNN', 'accuracy https 77 www'), 'mnist') (('nevi', 'visits'), 'follow') (('I', 'training'), 'Approach') (('relatively shallow CNN', 'when 2 classes'), 'finding') (('training 10000 images', 'Machine'), 'dataset') (('75 so it', 'time'), 'be') (('network However deep pre trained ResNet50', 'class'), 'achieve') (('relatively shallow CNN', 'when 2 classes'), 'see') (('one', 'hand'), 'resnet') (('It', 'compile model fit already model'), 'train') (('you', 'class'), 'need') (('why we', '100 75'), 'resize') (('confocal microscopy', 'histogram manual changes'), 'be') (('This', 'well relatively small datasets'), 'demonstrate') (('Consensus', 'authors'), 'provide') (('we', 'artificially HAM'), 'need') (('which', '1'), 'check') (('only authors', 'independently same unequivocal benign diagnosis'), 'apply') (('Histopathology Histo Histopathologic diagnoses', 'specialized dermatopathologists'), 'beenperforme') "}