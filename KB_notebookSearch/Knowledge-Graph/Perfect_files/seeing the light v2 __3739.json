{"name": "seeing the light v2 ", "full_name": " h2 Data exploration h2 1 Load the data h2 2 Plot intensity over time h2 3 Compute the periods h2 4 Compare the smaller regions ", "stargazers_count": 0, "forks_count": 0, "description": "Getting a more exact value for the period would be nice in fact this is possible if we combine the two methods and compute autocorrelation with the fft This means that the dominant period for the whole dataset is 24. This can be seen more clearly if we instead select time frames corresponding to daylight I would guess that these slower changes have technical reasons such as diffusion excretion of a contrast agent. Over time this would cause them to be completely out of phase with the day night cycle. In this notebook we have explored some basic properties. We cannot really tell what happens there but for a more detailed analysis it might be a good idea to analyse time 75 separately. It doesn t really make much sense that light sensitive neurons in a realistic setting vary in anything else than 24 hours. To estimate this part we use linear regression. The dataset look at the day night variation of protein expression in certain neurons. I ll end this notebook here. Looking at a few of them we see that they vary greatly in amplitude but the period seems to be correct. This suggests that the period is slightly smaller around 23 hours in the center of the two bright nuclei and close to 25 hours at the periphery. The light corresponds to a certain protein whose expression varies over the day night cycle and our goal is to characterize this variation over time. Plot intensity over timeNow we take the mean intensity over the whole image and plot it against time. Plot how mean intensity varies over time 3. And let s just plot one image to see what we re working with As can be seen in the dataset description this is a section of mouse brain. We can see that there is a linear trend towards higher values late in the week. In this notebook we will just apply a high pass filter when needed. This means that we will only really need images for the analysis and not the other data arrays. Take a closer look at the subregions 1. We can now look at some images separated by 12 hours and see if the light intensity varies as expected This does indeed show some day night variation but it also shows how the vertical line in the middle becomes gradually more intense maybe explaining the linear trend we subtracted previously. First a simple plot to show that there are exactly ten images each hour. Autocorrelation gives a more exact answer here also showing a peak at 24 hours. I reshape some arrays to make them work with scikit learn. The two bright ovals are the suprachiasmatic nuclei and the vertical line at the top is the third ventricle. We see that the overall shape is periodic but the graph also suggests a discontinuity in the data at 40 hours and 75 hours. As will be seen in the section below there is still much noise artifact in the data which would confuse our simple functions even with the filters on. We collect the linear regression in a function for later use. Compare the smaller regions We now divide the area into smaller squares to see what the local period is. Compute the periodsA fast way to get the dominant period is the Fast Fourier Transform FFT just take the frequency that gives the maximum value in the graph below This is however only approximate we cannot this easily tell if the period is really 24 hrs or say 23 hours. The results above suggest that all regions have period close to 24 hours. At the bottom is the optic nerve cannot be seen. Compute periods numerically 4. I am not sure that this is true for several reasons 1. I learnt a lot doing this hope you enjoyed it as well linear algebra graphs to smooth images because there are ten image frames per hour. We also collected the autocorrelations for subregions. ", "id": "toregil/seeing-the-light-v2", "size": "3739", "language": "python", "html_url": "https://www.kaggle.com/code/toregil/seeing-the-light-v2", "git_url": "https://www.kaggle.com/code/toregil/seeing-the-light-v2", "script": "get_period sklearn.linear_model get_grid_periods subprocess matplotlib.pyplot remove_linear_trend LinearRegression filtered_acorr check_output uniform_filter # to smooth images scipy.ndimage.filters numpy ", "entities": "(('we', 'time'), 'intensity') (('dominant period', 'whole dataset'), 'be') (('we', 'linear regression'), 'use') (('them', 'day night cycle'), 'cause') (('this', 'mouse brain'), 'let') (('light sensitive neurons', 'else 24 hours'), 'doesn') (('it', 'good time'), 'tell') (('We', 'later use'), 'collect') (('We', 'late week'), 'see') (('slower changes', 'contrast agent'), 'see') (('local period', 'smaller squares'), 'compare') (('dataset', 'certain neurons'), 'look') (('you', 'image ten hour'), 'learn') (('Autocorrelation', '24 hours'), 'give') (('optic nerve', 'bottom'), 'be') (('this', 'several reasons'), 'be') (('we', 'analysis'), 'mean') (('graph', '40 hours'), 'see') (('We', 'subregions'), 'collect') (('them', 'scikit learn'), 'reshape') (('we', 'pass just high filter'), 'apply') (('easily period', 'really 24 23 hours'), 'be') (('period', 'greatly amplitude'), 'see') (('goal', 'time'), 'correspond') (('above regions', 'period'), 'suggest') (('we', 'basic properties'), 'explore') (('how mean intensity', 'time'), 'plot') (('even filters', 'simple functions'), 'be') (('two bright ovals', 'suprachiasmatic vertical top'), 'be') (('period', 'close to 25 periphery'), 'suggest') (('we', 'gradually more linear trend'), 'look') "}