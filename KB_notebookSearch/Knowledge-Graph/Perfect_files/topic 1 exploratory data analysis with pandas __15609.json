{"name": "topic 1 exploratory data analysis with pandas ", "full_name": " h2 mlcourse ai Open Machine Learning Course h1 Topic 1 Exploratory data analysis with Pandas h2 Article outline h2 1 Demonstration of main Pandas methods h3 Sorting h3 Indexing and retrieving data h3 Applying Functions to Cells Columns and Rows h3 Grouping h3 Summary tables h3 DataFrame transformations h2 2 First attempt at predicting telecom churn h2 3 Assignments h3 Demo version h3 Bonus version h2 4 Useful resources h2 Support course creators ", "stargazers_count": 0, "forks_count": 0, "description": "We see that one feature is logical bool 3 features are of type object and 16 features are numeric. com user francisco gallery dataset 5163ad540c0b5e5b22000383 on the churn rate of telecom operator clients. org github Yorko mlcourse. If you are already familiar with these topics you can wait for the 3rd article in the series where we get into machine learning. Bonus versionYou can also choose a Bonus Assignments tier https www. ai and YouTube channel https www. Finally one or several functions are applied to the obtained groups per selected columns. 8 that we got through this very simple reasoning serves as a good starting point baseline for the further machine learning models that we will build. ai tutorials Handle different dataset with dask and trying a little dask ML https nbviewer. Now let s try printing out column names using columns We can use the info method to output some general information about the dataframe bool int64 float64 and object are the data types of our features. Next let s look at another important feature Customer service calls. ai Main course site https mlcourse. Then columns of interest are selected columns_to_show. com pandas dev pandas blob master doc cheatsheet Pandas_Cheat_Sheet. For example if we want to calculate the total number of calls for all users let s create the total_calls Series and paste it into the DataFrame It is possible to add a column more easily without creating an intermediate Series instance To delete columns or rows use the drop method passing the required indexes and the axis parameter 1 if you delete columns and nothing or 0 if you delete rows. Pandas makes it very convenient to load process and analyze such tabular data using SQL like queries. Subsequently we ll talk about decision trees and figure out how to find such rules automatically based only on the input data We got these two baselines without applying machine learning and they ll serve as the starting point for our subsequent models. The former is a one dimensional indexed array of some fixed data type. 5 per se then possibly we are doing something wrong and it suffices to confine ourselves to a simple model with two conditions Before training complex models it is recommended to manipulate the data a bit make some plots and check simple assumptions. org pandas docs stable 10min. org licenses by nc sa 4. To calculate fractions pass normalize True to the value_counts function. Let s have a look at the distribution of Churn 2850 users out of 3333 are loyal their Churn value is 0. Here there are none because each column contains 3333 observations the same number of rows we saw before with shape. html Pandas cheatsheet PDF https github. DataFrames are great for representing real data rows correspond to instances examples observations etc. The inplace argument tells whether to change the original DataFrame. html tutorials on pandas numpy matplotlib and scikit learn Support course creatorsYou can make a monthly Patreon or one time Ko Fi donation. We ll demonstrate the main methods in action by analyzing a dataset https bigml. com TomAugspurger effective pandas scipy lectures. Pandas http pandas. org is a Python library that provides extensive means for data analysis. ru company ods blog 322626 on Habr. We see that with International Plan the churn rate is much higher which is an interesting observation Perhaps large and poorly controlled expenses with international calls are very conflict prone and lead to dissatisfaction among the telecom operator s customers. Therefore predicting that a customer is not loyal Churn 1 in the case when the number of calls to the service center is greater than 3 and the International Plan is added and predicting Churn 0 otherwise we might expect an accuracy of 85. For example we can sort by Total day charge use ascending False to sort in descending order We can also sort by multiple columns Indexing and retrieving dataA DataFrame can be indexed in a few different ways. Now let s add a binary feature to our DataFrame Customer service calls 3. com kashnitsky a1 demo pandas and uci adult dataset where you ll be analyzing socio demographic data. 8 we are mistaken only 464 9 times. From the output we can see that the table contains 3333 rows and 20 columns. And of course pivot tables are implemented in Pandas the pivot_table method takes the following parameters values a list of variables to calculate statistics for index a list of variables to group data by aggfunc what statistics we need to calculate for groups ex. In the second case we say give us the values of the first five rows in the first three columns as in a typical Python slice the maximal value is not included. In conjunction with Matplotlib and Seaborn Pandas provides a wide range of opportunities for visual analysis of tabular data. com open machine learning course open machine learning course topic 1 exploratory data analysis with pandas de57880f1a68 based on this notebook If you read Russian an article https habrahabr. Data scientists often work with data stored in table formats like. com guipsamora pandas_exercises and Effective Pandas https github. org pandas docs stable index. The main data structures in Pandas are implemented with Series and DataFrame classes. Let s also make a summary table and a picture. Useful resources The same notebook as an interactive web based Kaggle Notebook https www. And once again let s see how it relates to churn. The most naive model that always predicts a loyal customer on such data will guess right in about 85. Demonstration of main Pandas methods 2. First attempt at predicting telecom churn 3. com in yuanyuanpao Anastasia Manokhina https www. com in anastasiamanokhina Sergey Isaev and Artem Trunov https www. Let s take a look at the average number of day evening and night calls by area code DataFrame transformationsLike many other things in Pandas adding columns to a DataFrame is doable in many ways. And a lecture https youtu. head is less nicely formatted. Exploratory data analysis with Pandas Article outline1. By default Pandas displays 20 columns and 60 rows so if your DataFrame is bigger use the set_option function as shown in the example below pythonpd. Let s construct another contingency table that relates Churn with both International plan and freshly created Many_service_calls. The loc method is used for indexing by name while iloc is used for indexing by number. If it turns out that with enormous effort we increase the share of correct answers by 0. That is the proportion of correct answers accuracy of subsequent models should be no less than this number and will hopefully be significantly higher With the help of a simple forecast that can be expressed by the following formula International plan True Customer Service calls 3 Churn 1 else Churn 0 we can expect a guessing rate of 85. Translated and edited by Christina Butsko https www. Useful resources 4. Here is an example where we group the data according to the values of the Churn variable and display statistics of three columns in each group Let s do the same thing but slightly differently by passing a list of functions to agg Summary tablesSuppose we want to see how the observations in our sample are distributed in the context of two variables Churn and International plan. Demonstration of main Pandas methods 1. sum mean maximum minimum or something else. html Course materials as a Kaggle Dataset https www. ai main page and get a non demo version of the assignment where the history of Olympic Games is analyzed with Pandas. In order to see statistics on non numerical features one has to explicitly indicate data types of interest in the include parameter. For example if we need to select all states starting with W we can do it like this The map method can be used to replace values in a column by passing a dictionary of the form old_value new_value as its argument The same thing can be done with the replace method GroupingIn general grouping data in Pandas works as follows pythondf. First attempt at predicting telecom churnLet s see how churn rate is related to the International plan feature. As we move on in this course recall that before the advent of machine learning the data analysis process looked something like this. Useful resources 1. The result of such indexing is the DataFrame consisting only of rows that satisfy the P condition on the Name column. This will resemble pivot tables to those familiar with Excel. com with the same material. Demonstration of main Pandas methodsWell. There are dozens of cool tutorials on Pandas and visual data analysis. Let s use it to answer the question What are average values of numerical features for churned users How much time on average do churned users spend on the phone during daytime What is the maximum length of international calls among loyal users Churn 0 who do not have an international plan DataFrames can be indexed by column name label or row name index or by the serial number of a row. Moreover in business applications of machine learning they usually start with simple solutions and then experiment with more complex ones. First the groupby method divides the grouping_columns by their values. Lambda functions are very convenient in such scenarios. Let s recap what we ve covered The share of loyal clients in the sample is 85. com watch v QKTuw4PNOsU list PLVlY_7IJCMJeRfZ68eVfEcu UcN9BbwiX Official Pandas documentation http pandas. First attempt at predicting telecom churn 2. ai blob master jupyter_english tutorials dask_objects_and_little_dask_ml_tutorial_iknyazeva. Boolean indexing with one column is also very convenient. In the first case below we say give us the values of the rows with index from 0 to 5 inclusive and columns labeled from State to Area code inclusive. com kashnitsky topic 1 exploratory data analysis with pandas Merging DataFrames with pandas https nbviewer. com in christinabutsko Yuanyuan Pao https www. The latter is a two dimensional data structure a table where each column contains data of the same type. For categorical type object and boolean type bool features we can use the value_counts method. ai course repo https github. and columns correspond to features of these instances. The syntax is df P df Name where P is some logical condition that is checked for each element of the Name column. Let s read the data using read_csv and take a look at the first 5 lines using the head method About printing DataFrames in Jupyter notebooksIn Jupyter notebooks Pandas DataFrames are printed as these pretty tables seen above while print df. We can change the column type with the astype method. groupby by grouping_columns columns_to_show. To do so we can build a contingency table using the crosstab method We can see that most of the users are loyal and do not use additional services International Plan Voice mail. With this same method we can easily see if there are any missing values. Assignments Demo versionTo practice with Pandas and EDA you can complete this demo assignment https www. Although it s not so obvious from the summary table it s easy to see from the above plot that the churn rate increases sharply from 4 customer service calls and above. Free use is permitted for any non commercial purpose. The assignment is just for you to practice and goes with solution https www. This material is subject to the terms and conditions of the Creative Commons CC BY NC SA 4. ai blob master jupyter_english tutorials merging_dataframes_tutorial_max_palko. If columns_to_show is not included all non groupby clauses will be included. SortingA DataFrame can be sorted by the value of one of the variables i. com ods_mlcourse details are outlined on the mlcourse. Let s use this to answer a question about that column alone what is the proportion of churned users in our dataframe 14. com kashnitsky a1 demo pandas and uci adult dataset solution. With inplace False the drop method doesn t change the existing DataFrame and returns a new one with dropped rows or columns. To get a single column you can use a DataFrame Name construction. You can see it as a dictionary of Series instances. 8 which is just above 85. ipynb a tutorial by Irina Knyazeva within mlcourse. pdf GitHub repos Pandas exercises https github. ai Open Machine Learning Course Author Yury Kashnitsky https yorko. max_rows 100 Recall that each row corresponds to one client an instance and columns are features of this instance. To do this specify axis 1. ai full list of tutorials is here https mlcourse. com kashnitsky mlcourse Medium story https medium. With inplace True it alters the DataFrame. be dEFxoyJhm3Y on YouTube 10 minutes to pandas http pandas. 5 is actually quite bad for a company such a churn rate can make the company go bankrupt. Let s have a look at data dimensionality feature names and feature types. They become a new index in the resulting dataframe. ipynb a tutorial by Max Plako within mlcourse. Let s apply this method to the Churn feature to convert it into int64 The describe method shows basic statistical characteristics of each numerical feature int64 and float64 types number of non missing values mean standard deviation range median 0. 0 https creativecommons. If we need the first or the last line of the data frame we can use the df 1 or df 1 construct Applying Functions to Cells Columns and Rows To apply functions to each column use apply The apply method can also be used to apply a function to each row. We ll do this using a crosstab contingency table and also through visual analysis with Seaborn however visual analysis will be covered more thoroughly in the next article. ", "id": "kashnitsky/topic-1-exploratory-data-analysis-with-pandas", "size": "15609", "language": "python", "html_url": "https://www.kaggle.com/code/kashnitsky/topic-1-exploratory-data-analysis-with-pandas", "git_url": "https://www.kaggle.com/code/kashnitsky/topic-1-exploratory-data-analysis-with-pandas", "script": "seaborn pandas matplotlib.pyplot numpy ", "entities": "(('company', 'actually quite company'), 'be') (('where we', 'machine learning'), 'be') (('you', 'demo assignment https www'), 'practice') (('we', 'Area'), 'say') (('material', 'NC SA'), 'be') (('data main structures', 'Series classes'), 'implement') (('Next s', 'feature Customer service important calls'), 'let') (('just you', 'solution https www'), 'be') (('basic statistical characteristics', 'deviation range standard median'), 'let') (('where you', 'socio demographic data'), 'demo') (('ai tutorials', 'dask ML https little nbviewer'), 'handle') (('sum', 'maximum minimum'), 'mean') (('it', 'simple assumptions'), 'do') (('We', 'astype method'), 'change') (('We', 'https dataset bigml'), 'demonstrate') (('that', 'right about 85'), 'guess') (('Finally one functions', 'selected columns'), 'apply') (('churn how rate', 'plan International feature'), 'see') (('inplace argument', 'original DataFrame'), 'tell') (('you', 'DataFrame Name construction'), 'get') (('Then columns', 'interest'), 'select') (('Bonus versionYou', 'Bonus Assignments tier https also www'), 'choose') (('Data scientists', 'table formats'), 'work') (('Free use', 'non commercial purpose'), 'permit') (('Now s', '3'), 'let') (('dataA DataFrame', 'a few different ways'), 'sort') (('apply method', 'row'), 'apply') (('They', 'new resulting dataframe'), 'become') (('churn rate', 'customer service sharply 4 calls'), 's') (('table', '3333 rows'), 'see') (('maximal value', 'Python typical slice'), 'say') (('First attempt', 'telecom'), 'churn') (('pdf GitHub repos Pandas', 'https github'), 'exercise') (('We', 'data features'), 'let') (('we', 'that'), 'serve') (('advent', 'this'), 'recall') (('former', 'data one dimensional indexed fixed type'), 'be') (('where history', 'Pandas'), 'ai') (('we', 'groups ex'), 'implement') (('logical that', 'Name column'), 'be') (('alone proportion', 'dataframe'), 'let') (('they', 'then more complex ones'), 'start') (('DataFrames', 'etc'), 'be') (('You', 'Series instances'), 'see') (('SortingA DataFrame', 'variables'), 'sort') (('ai', 'full tutorials'), 'be') (('one', 'include parameter'), 'have') (('DataFrames', 'row'), 'let') (('Python that', 'data analysis'), 'be') (('grouping GroupingIn general data', 'pythondf'), 'do') (('60 DataFrame', 'pythonpd'), 'display') (('com ods_mlcourse details', 'mlcourse'), 'outline') (('we', '0'), 'turn') (('instance columns', 'instance'), 'max_rows') (('com kashnitsky a1', 'adult dataset solution'), 'demo') (('you', 'rows'), 'for') (('we', 'same method'), 'see') (('com user francisco gallery', 'telecom operator clients'), 'dataset') (('0 otherwise we', '85'), 'predict') (('that', 'Name column'), 'be') (('it', 'queries'), 'make') (('Lambda functions', 'very such scenarios'), 'be') (('Boolean indexing', 'one column'), 'be') (('Support creatorsYou', 'monthly Patreon'), 'numpy') (('3 1 else 0 we', '85'), 'be') (('they', 'subsequent models'), 'talk') (('where column', 'same type'), 'be') (('it', 'DataFrame'), 'alter') (('we', 'before shape'), 'be') (('16 features', 'type object'), 'see') (('This', 'familiar Excel'), 'resemble') (('Official Pandas PLVlY_7IJCMJeRfZ68eVfEcu documentation', 'pandas'), 'watch') (('type bool boolean we', 'value_counts method'), 'use') (('s', 'also summary table'), 'let') (('columns', 'instances'), 'correspond') (('groupby First method', 'values'), 'divide') (('iloc', 'number'), 'use') (('Churn value', '3333'), 'let') (('drop method doesn', 'dropped rows'), 'change') (('how observations', 'two variables'), 'be') (('ve share', 'sample'), 'let') (('many other things', 'many ways'), 'let') (('you', 'article https habrahabr'), 'com') (('s', 'data dimensionality feature names'), 'let') (('most', 'International Plan Voice mail'), 'build') (('that', 'International plan'), 'let') (('We', 'more thoroughly next article'), 'do') (('much which', 'telecom customers'), 'see') (('Jupyter notebooks Pandas Jupyter notebooksIn DataFrames', 'pretty tables'), 'let') "}