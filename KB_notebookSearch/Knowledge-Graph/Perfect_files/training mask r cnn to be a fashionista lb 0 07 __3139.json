{"name": "training mask r cnn to be a fashionista lb 0 07 ", "full_name": " h1 Dowload Libraries and Pretrained Weights h1 Set Config h1 Make Datasets h1 Train h1 Predict ", "stargazers_count": 0, "forks_count": 0, "description": "When clicking Submit to Competition button I always run into 404 erros so I have to save a submission file and upload it to the submission page for submitting. Dowload Libraries and Pretrained Weights Set ConfigMask R CNN has a load of hyperparameters. com c imaterialist fashion 2019 FGVC6 discussion 90643 523135 80 of images have no attribute. com hmendonca mask rcnn and coco transfer learning lb 0 155 and borrowed some ideas from the U Net Baseline kernel https www. PredictThe final step is to use our model to predict test data. The crucial part is to create a dataset for this task. I only adjust some of them. com matterport Mask_RCNN and a deep learning line of researches culminating in Mask R CNN https arxiv. Importantly an image segmentation task can be accomplished with short code and good accuracy thanks to Matterport s implementation https github. I just started working for this competition about a week ago and to my surprise the score fell in the range of silver medals at that time. I am sorry that I published this kernel quite late beyond the halfway of a timeline. I have no dedicated GPU and no time to further tune the model so I decided to make this kernel public as a starter guide for anyone who is interested to join this delightful competition. Rows with the same image are grouped together because the subsequent operations perform in an image level. Then all layers are trained. If there are any bugs please let me know. Afterwards we reduce LR and train again. Let s visualize training history and choose the best epoch. The public LB score of this kernel is around 0. com go1dfish u net baseline by pytorch in fgvc6 resize. For demonstration purpose the classification ignores attributes only categories and the image size is set to 512 which is the same as the size of submission masks to prevent an error when the kernel is committed to prevent displaying images at the bottom of a kernel 1 for the background class a memory error occurs when IMAGES_PER_GPU is too high STEPS_PER_EPOCH should be the number of instances divided by GPU_COUNT IMAGES_PER_GPU and so should VALIDATION_STEPS however due to the time limit I set them so that this kernel can be run in 9 hours Add classes Add images This code partially supports k fold training you can specify the fold to train and the total number of folds here ideally this should be multilabel stratification Note that any hyperparameters here such as LR may still not be optimal only horizontal flip here train heads with higher lr to speedup learning Convert data to run length encoding Since the submission system does not permit overlapped masks we have to fix them The system does not allow missing ids this is an easy way to fill them. 46 of data and according to the host https www. Hope you guys like this kernel. The submission file is created when all predictions are ready. Now the data are partitioned into train and validation sets. So in the first step we can only deal with categories to reduce the complexity of the task. My code is largely based on this Mask RCNN kernel https www. Here is the main prediction steps along with some helper functions. First we train only the heads. com c imaterialist fashion 2019 FGVC6. Here is the custom function that resizes an image. TrainThis section creates a Mask R CNN model and specifies augmentations to be used. So I would like to thank the kernel authors for sharing insights and programming techniques. Make DatasetsSegments that contain attributes are only 3. Let s visualize some random images and their masks. Then load the submission data. Finally it s pleasing to visualize the results Sample images contain both fashion models and predictions from the Mask R CNN model. Let s visualize class distributions of the train and validation data. This cell defines InferenceConfig and loads the best trained model. Welcome to the world where fashion meets computer vision This is a starter kernel that applies Mask R CNN with COCO pretrained weights to the task of iMaterialist Fashion 2019 at FGVC6 https www. ", "id": "pednoi/training-mask-r-cnn-to-be-a-fashionista-lb-0-07", "size": "3139", "language": "python", "html_url": "https://www.kaggle.com/code/pednoi/training-mask-r-cnn-to-be-a-fashionista-lb-0-07", "git_url": "https://www.kaggle.com/code/pednoi/training-mask-r-cnn-to-be-a-fashionista-lb-0-07", "script": "mrcnn pathlib get_fold refine_masks numpy resize_image augmenters Path mrcnn.model InferenceConfig(FashionConfig) utils image_reference Config imgaug tqdm mrcnn.config to_rle StratifiedKFold KFold matplotlib.pyplot sklearn.model_selection pandas FashionConfig(Config) augmenters as iaa FashionDataset(utils.Dataset) __init__ load_mask visualize load_image log ", "entities": "(('crucial part', 'task'), 'be') (('Dowload Libraries', 'hyperparameters'), 'have') (('this', 'easy them'), 'attribute') (('I', 'submitting'), 'run') (('Now data', 'train sets'), 'partition') (('com c FGVC6 imaterialist fashion 2019 discussion', 'attribute'), 'have') (('image segmentation Importantly task', 'implementation https good thanks github'), 'accomplish') (('PredictThe final step', 'test data'), 'be') (('together subsequent operations', 'image level'), 'group') (('prediction Here main steps', 'helper functions'), 'be') (('that', 'image'), 'be') (('cell', 'best trained model'), 'define') (('that', 'attributes'), 'make') (('s', 'train data'), 'let') (('s', 'random images'), 'let') (('COCO', 'FGVC6 https 2019 www'), 'welcome') (('code', 'Mask RCNN kernel https largely www'), 'base') (('who', 'delightful competition'), 'have') (('hmendonca mask', 'U Net Baseline kernel https www'), 'com') (('LB public score', 'kernel'), 'be') (('s', 'best epoch'), 'let') (('I', 'timeline'), 'be') (('we', 'task'), 'deal') (('Sample images', 'Mask R CNN model'), 's') (('augmentations', 'Mask R CNN model'), 'create') (('So I', 'insights'), 'like') (('score', 'time'), 'start') "}