{"name": "face and facial keypoint detection ", "full_name": " h2 Face and Facial Keypoint detection h4 Select an image h2 Detect all faces in an image h2 Loading in a trained model h2 Keypoint detection h3 TODO Transform each detected face into an input Tensor h3 TODO Detect and display the predicted keypoints ", "stargazers_count": 0, "forks_count": 0, "description": "The ouput should be the predicted the facial keypoints. html as an optional exercise in using Haar detectors. An example of face detection on a variety of images is shown below. In the next python cell we load in required libraries for this section of the project. load saved_models keypoints_model_1. Detect all faces in an imageNext you ll use one of OpenCV s pre trained Haar Cascade classifiers all of which can be found in the detector_architectures directory to find any faces in your selected image. First load your best model by its filename. You may find it useful to consult to transformation code in data_load. Convert the face from RGB to grayscale2. If you find that your model is generating keypoints that are too small for a given face try adding some padding to the detected roi before giving it as input to your model. Rescale the detected face to be the expected square size for your CNN 224x224 suggested 4. This step will be similar to the data_transform you created and applied in Notebook 2 whose job was tp rescale normalize and turn any iimage into a Tensor to be accepted as input to your CNN. load_state_dict torch. TODO Transform each detected face into an input TensorYou ll need to perform the following steps for each detected face 1. In the code below we loop over each face in the original image and draw a red square on each face in a copy of the original image so as not to modify the original. Detect all the faces in an image using a face detector we ll be using a Haar Cascade detector in this notebook. Face and Facial Keypoint detectionAfter you ve trained a neural network to detect facial keypoints you can then apply this network to any image that includes faces. Hint The sizes of faces detected by a Haar detector and the faces your network has been trained on are of different sizes. These keypoints will need to be un normalized for display and you may find it helpful to write a helper function like show_keypoints. Loading in a trained modelOnce you have an image to work with and again you can select any image of faces in the images directory the next step is to pre process that image and feed it into your CNN facial keypoint detector. 1 d7 d8b tutorial_py_face_detection. The neural network expects a Tensor of a certain size as input and so to detect any face you ll first have to do some pre processing. Use your trained model to detect facial keypoints on the image. eval loop over detected faces with haar cascade now we select region of interest which is face in image roi norm_gray. Keypoint detectionNow we ll loop over each detected face in an image again only this time you ll transform those faces in Tensors that your CNN can accept as input images. Reshape the numpy image into a torch image. Pre process those face images so that they are grayscale and transformed to a Tensor of the input size that your net expects. py to help you perform these processing steps. You can even add eye detections https docs. TODO Detect and display the predicted keypointsAfter each face has been appropriately converted into an input Tensor for your network to see as input you can apply your net to each face. numpy reshape to batch_size x 68 x 2 pts load color image for face detection conert RED as in many images load in a haar cascade classifier for detecting frontal faces run detector loop over the detected faces draw a rectangle around each detected face loop over the detected faces from your haar cascade Select the region of interest that is the face in the image. Select an image Select an image to perform facial keypoint detection on you can select any image of faces in the images directory. You should end up with an image like the following with facial keypoints that closely match the facial features on each individual face load in color image for face detection switch red and blue color channels by default OpenCV assumes BLUE comes first not RED as in many images plot the image load in a haar cascade classifier for detecting frontal faces run the detector the output here is an array of detections the corners of each detection box if necessary modify these parameters until you successfully identify every face in a given image make a copy of the original image to plot detections on loop over the detected faces mark the image where each face is found draw a rectangle around each detected face you may also need to change the width of the rectangle drawn depending on image resolution net. Normalize the grayscale image so that its color range falls in 0 1 instead of 0 255 3. ", "id": "nancyalaswad90/face-and-facial-keypoint-detection", "size": "3614", "language": "python", "html_url": "https://www.kaggle.com/code/nancyalaswad90/face-and-facial-keypoint-detection", "git_url": "https://www.kaggle.com/code/nancyalaswad90/face-and-facial-keypoint-detection", "script": "transforms torchvision matplotlib.image ToTensor data_load matplotlib.pyplot Normalize utils Rescale models Net numpy ", "entities": "(('that', 'faces'), 'face') (('Rescale', '224x224 4'), 'suggest') (('we', 'original'), 'loop') (('you', 'face'), 'convert') (('2 job', 'CNN'), 'be') (('we', 'project'), 'load') (('it', 'data_load'), 'find') (('TensorYou', 'detected face'), 'transform') (('next step', 'keypoint CNN facial detector'), 'have') (('CNN', 'input images'), 'transform') (('color range', '255 1 instead 0 3'), 'normalize') (('sizes', 'are different sizes'), 'Hint') (('you', 'image resolution net'), 'end') (('that', 'model'), 'try') (('it', 'show_keypoints'), 'need') (('that', 'image'), 'conert') (('You', 'eye detections https even docs'), 'add') (('you', 'processing steps'), 'py') (('example', 'images'), 'show') (('you', 'pre first processing'), 'expect') (('Select', 'images directory'), 'select') (('we', 'notebook'), 'detect') (('Haar Cascade trained all', 'selected image'), 'use') (('which', 'image'), 'select') (('net', 'that'), 'process') "}