{"name": "dysonian seti with machine learning ", "full_name": " h2 Synopsis h2 Introduction h2 Boilerplate code h2 Data h2 Modeling strategy h2 Decorators data selection h2 Spectrophotometic distance error h2 Model variables h2 Linear modelling h2 First GBM model h2 Second GBM Model h2 Neural Network h2 Blend h2 Model error h2 Residual modeling h2 Final transformation and validation h2 Candidate selection h2 Model and H R diagrams h2 Space distribution of candidates h2 Clustering analysis h2 Output files h2 Other subsets h2 Discussion h2 Acknowledgments h2 References ", "stargazers_count": 0, "forks_count": 0, "description": "2018 suggested that stars with Dyson Swarms would have spectrophotometric distances that exceed their parallax distances. The cross distance frame looks as follows. csv An equal number of ordinary stars. Model responses are cross validated so they can be used as inputs of other models. The problem with this approach is that real world data does not have a normal distribution. A blend of GBMs and a Neural Network produces an RMSE of 0. We want a model that always produces positive responses. 23 magnitudes when we select only stars with parallax of 2. A Random Forest essentially produces averages of labels over some training examples which is intuitively in line with what we want to accomplish. Instead it s typically long tailed. com solorzano multi stellar seti candidate selection part 1 IntroductionDysonian SETI is a proposed approach in the search for extraterrestrial civilizations Bradbury et al. There is a technical reason for this. In preliminary analysis we found that many potential candidates appear to be below the main sequence in an H R diagram but upon further examination it was clear these are stars with high parallax error. There are pairs of candidates and bright controls that are very close to one another in the sky. In particular we need a function that can produce a transform from an arbitrary regression model. However within included data there are still differences in model error that are characterizable. Let s check the error_ column that the test data should now have. We will split the candidates frame into two subgroups called candidates_bright and candidates_mainseq using the dashed blue line. One possibility is to check how the error distribution compares to a normal distribution. Follow ups Dysonian SETI with ML Squared Residual Meta Model https www. Earth is at 0 0 0. It should be noted that all of the above are high proper motion stars. That could be explored but it seems it would allow the meta model to discover brightness and color based patterns which would cause us to discard potentially valid candidates. It s valid to use the response of a model as a variable of another model so long as the response is out of bag. The reason why galactic latitude and longitude are variables of the residual meta model is precisely to try to address observed clustering. A blend does not have to be linear but in this case that appears to be the best choice. First let s get a random sample of 1000 stars from the data. The rest are shown in green. the regression label from a frame. They can be picked out as follows. The possibility of contamination or incorrect cross identification should be studied further. standard margin of error. We could be discarding valid candidates. This hypothesis is easily discarded by removing latitude and longitude from the set of variables. Our blend is only slightly better than our best individual model. Let s also get an equal number of anomalously bright controls. 5 400 parsecs and a maximum parallax error of 0. Interstellar extinction is neglected in the absolute magnitude estimate. We will compare the Rave DR5 spectrophotometric distance modulus with the Gaia DR2 parallax based distance modulus. That s why we include both the distance and the logarithm of the distance as variables. Defining a threshold is a subjective exercise. This should be taken into account going forward The model seems to smooth out anomalies though not entirely as it detects region dependent patterns. We will add a dashed blue line to the H R diagram intended to separate main sequence stars from giants. Both of these subsets should have a distance bias given that we control for the expected absolute residuals of the model and those residuals are distance dependent. Two additional lines show the lower bound of the 95 red and 99 blue confidence intervals. Let s check what the mean absolute proper motion values are for stars that are at most 75 parsecs away. In addition to RAVE DR5 measurements the dataset includes cross identified features from Gaia DR2 APASS DR9 ALLWISE and DENIS. If they didn t that would be evident once we look at the test data we set aside. Note that we will be modeling the G magnitude of a star as provided by Gaia DR2. We want to minimize the error but we also want a reasonable number of candidates for follow up analyses. RAVE DR5 also provides metal abundance and metallicity features that seem to help. We ll also get an equally sized list of ordinary controls. We will use the TreeBoost implementation from xgboost https xgboost. DiscussionWe have produced a model of stellar magnitude as a function of Gaia DR2 parallax distance and spectrophotometric features from a number of databases. Now we ll create a function that runs the whole transform sequence on a frame and apply it to the test data we had initially set aside. We additionally include a special transformation of the latitude based on the assumption that a region close to latitude zero has increased extinction. With additional spectral features a better approximation of the absolute magnitude can be derived. This RMSE is nearly a third of the discrepancy between Gaia parallax and RAVE spectrophotometric distance moduli. GR defined below is a hyperpameter of this special variable. Model errorLet s create a transform that will add an error_ column with the residuals of the blend. Model and H R diagramsWe will now look at some visualizations of model results. The transform will add model responses as a new column of the frame. observed absolute magnitude. The dashed orange line shows the expected null hypothesis frequency. In a Gaia only H R diagram anomalously bright sources are typically giants. Additionally in preliminary analysis we found that anomalously dim candidates cluster so we are making sure that any regional error patters are taken into account by using distance longitude and latitude as variables of the residual model. a model response and a label for purposes of model evaluation. We will use linear regression to produce the blend model. The abs_mag_value function below will convert a magnitude column in a data frame into an absolute magnitude. Theoretically the difference between the magnitude of a star and its absolute magnitude is a linear function of the logarithm of the star s distance. _Dysonian Approach to SETI A Fruitful Middle Ground _ Journal of the British Interplanetary Society vol. com solorzano new stellar magnitude model dysonian seti Multi Stellar SETI Candidate Selection https www. We find statistically significant stellar clustering in the group of anomalously dim candidates. Residual modelingWe have distance based and parallax error based exclusion criteria which helps improve model performance. In any case we did not find evidence of significant regional error patterns. Our 1000 random stars are shown in gray. AcknowledgmentsThis work has made use of data from the European Space Agency ESA mission Gaia https www. We would like to use the Gaia DR2 parallax distance not just its logarithm as a variable of the model in order to account for interstellar extinction. Decorators data selectionWe will start by limiting the data we will use to train models and obtain candidates. These thresholds can be changed below. Output filesThe following files are made available in the output tab of this kernel. The new frame will be ordered by distance. We also train a meta model of the model s absolute residuals and define anomaly as a residual divided by the expected absolute residual. The reader can change the LABEL_COLUMN variable below to model say RP or BP magnitudes. This is consistent with the RMSE observed in work_data. Instead of performing radio searches the approach involves looking for stars that host artificial megastructures. 03210Zackrisson et al. Additionally model error is distance dependent. com solorzano dysonian seti with ml squared residual meta model New Stellar Magnitude Model https www. We won t be using the RAVE spectrophotometric distance as a variable given that we expect it to leak information about magnitude. Regional error that is not reflected in the parallax_error field should have been discovered by the absolute residual meta model. Final transformation and validationLet s put all our transform functions into a list called transform_list. We can apply the full transform to the entire dataset. 23 magnitudes in cross validation which is nearly a third of the error between Gaia parallax and RAVE spectrophotometric distance moduli. The transform is also able to produce output for data that was not used in training. We will create a new frame where each row contains a pair of sources and their squared distance. Per the methodology previously outlined we will use this first transform function to alter our work_data frame. However we don t believe such a systematic explains the observed clustering. Additionally in the interactive 3D scatter chart we find a group of a few stars that are close to one another and relatively close to Earth. The following code tests incremental headsets of the ordered cross distance frame starting with the first 5 rows. Noisy data affects model precision and also increases the likelihood that candidates will be spurious. We re interested in rows where both sources are anomalously dim. Modeling strategyOur strategy will consist of transforming the work_data frame typically by adding columns to it at each step. We can mathematically test this conjecture. A more robust clustering test is presented in a cloned kernel Dysonian SETI With ML Squared Residual Meta Model https www. We note that anomalously dim candidates particularly those in the main sequence or below it exhibit stellar clustering. Anomalously dim candidates are selected at a cutoff of 3 sigma in the anomaly distribution and made available in the output tab of this kernel. csv Anomalously dim candidates that are in the main sequence or below. Funding for the DPAC has been provided by national institutions in particular the institutions participating in the Gaia Multilateral Agreement. First GBM modelNext we will build a Gradient Boosting Machine GBM. ReferencesBradbury et al. Let s compare anomalously dim candidates with bright controls. int gaia processed by the Gaia Data Processing and Analysis Consortium DPAC https www. We will use a minimum parallax of 2. Note that the 3D scatter is interactive. 5 or more and parallax error of 0. The next chart will be a Hertzsprung Russell H R diagram. Let s set aside a test data frame we will double check only after all of the cross validated models and transformations are tested using a work data frame. Let s calculate squared distances between all pairs of sources in the concatenated frame. One idea is that since the model uses galactic latitude and longitude as variables it might have introduced random regional irregularities in model responses. Specifically we will blend Gradient Boosting Machines GBMs and a Neural Network. Distance modulus errors should be equivalent to magnitude errors in terms of scaling. Linear modellingOur first regressor will be linear. Next we will define a function that obtains the variables of the absolute residual meta model. The separation line is defined by the separation_y function below which is visually derived. In this kernel we will model the magnitude of stars rather than their distance modulus. In other words Dysonian stars should be dimmer than their spectral characteristics would indicate. In order to do this we will create transform functions that take a frame and produce a new frame with altered data. Neural Network BlendWe will now blend the 4 individual models we previously produced. Clustering is more evident among candidates that are in the main sequence or below. _SETI with Gaia The observational signatures of nearly complete Dyson spheres_. Then we will build a meta model of the model s absolute residuals given that each star s measurements have errors that depend on its distance and other features. In order to account for interstellar extinction irregularities galactic latitude and longitude are variables of the model. Anomalously dim candidates green dots occur both in the main sequence and above it. We can therefore reject the null hypothesis. We will also add a couple decorator columns that are useful in visualizations the distance to the star in parsecs and the absolute magnitude abs_mag_ne of the star based on the G magnitude from Gaia DR2. Spectrophotometic distance errorLet s calculate a baseline Root Mean Squared Error RMSE for reference. There is a practical reason for this. It s possible to approximate the absolute magnitude of a star and therefore its probable distance given the star s color. Columns found in the data frame follow. If there s clustering of star types of interest that s somewhat of a problem. Primarily we will use color index features which are simply differences between magnitudes observed with different photometric filters. We will also define a function that compares two frame columns e. Our responses are cross validated so they should work. Further we will add two boolean columns to the cross distance frame indicating whether each of the sources in a pair are anomalously dim. Space distribution of candidatesLet s define a function that takes a data frame and converts distance galactic longitude and latitude to x y z coordinates. Outliers are to be expected and they are not indicative that we ve found anything unnatural nor are non outliers necessarily natural. Any subsample of the cross distance frame should also have a frequency of True True rows of 25 within statistical uncertainty if there s no clustering that depends on the modeled anomaly. The set of anomalously dim stars is shown in green. csv A list of anomalously bright controls. org project and made available in a Kaggle dataset https www. Boilerplate code DataData is obtained from the RAVE project https www. But we will take advantage of photometric features provided by RAVE DR5 from various other databases in addition to features found in Gaia DR2. Note that we don t use magnitude features. We will use a color index in the X axis defined as the difference between the Gaia provided BP and RP magnitudes. Anomalously dim sources are sometimes giants as well but most occur in the main sequence. com solorzano dysonian seti with ml squared residual meta model We will now concatenate the position frames of the candidates and bright controls. The set of bright controls is shown in orange. For this reason we will train a second GBM with slightly different hyperparameters so that the final model blend is more stable. Clustering could be explained as 1 a star type that exhibits clustering and can t be pinned down mathematically with the spectrophotometric features available to us or 2 a model or data artifact. It seems sensible to make adjustments based on each star s expected error. Indeed this is what we find if we look at the entire cross distance frame. For these reasons we will simply use a 3 sigma threshold to select our list of anomalously dim candidates. The extract_model_vars function takes a data frame and returns a variable matrix that is ready to be used with scikit learn style regressors with a fit function. Since extinction is likely irregular in our region of space we include galactic latitude and longitude as variables. Absolute residuals are always positive. The following transform function adds an anomaly_ column to a frame defined as the ratio between the model s residual and the expected absolute residual. Let s produce a second 3D scatter containing only the bright controls. 08351 Due to Pandas versioning issue plt. The variables were kept because of their slight contribution to meta model performance. Other subsetsIn the H R diagram there are a few anomalously dim stars that are slightly below the main sequence. But there s an additional extinction component that is roughly dependent on distance. dim candidates mainseq. SynopsisWe test a variant of the methodology outlined in Zackrisson et al. csv All sources that were used in training and candidate selection. First let s look at a chart of modeled absolute magnitude vs. The regressor we will use in this case is a Random Forest. Let s plot the results of this test. 2018 by modeling the g magnitude of 64K stars as a function of Gaia DR2 parallax and spectrophotometric features available in RAVE DR5. csv The list of anomalously dim candidates. There is just one function later in the analysis called separation_y that is visually derived and would need to be adjusted accordingly. Edit Distance distributions can change if the random seed changes and affect this clustering analysis. We will test machine learning algorithms that are able to deal with complex nonlinearities. Candidate selectionIt s not obvious how candidates should be selected. Clustering is in fact more pronounced if we remove latitude and longitude features. com solorzano rave dr5 gaia dr2 consolidated home. Model variablesLet s define the variables we will use to train regression models. Let s start by checking summary statistics of each of the subsets. The bright controls are only slightly farther away by 5 in average. A blend is a combination of multiple models so it should generally be more stable less long tailed than the individual models. We will define a function that extracts the absolute residual array i. int web gaia dpac consortium. So we have over a hundred anomalously dim candidates at the 3 sigma level. A high proper motion is not unusual however for stars that are close to Earth. hist can be very slow. Second GBM ModelGBMs are stochastic meaning that their responses include randomness that varies from one run to the next. Clustering analysisAnomalously dim candidates particularly those in the main sequence or below the blue ones in the 3D chart appear to cluster. _The Radial Velocity Experiment RAVE Fifth Data Release_. All model responses will be out of bag as we rely on k fold cross validation. Candidates in the main sequence or below are shown in blue. First we need a function that extracts the variables of the blend model which are simply the responses of the individual models. The expectation is that True True rows occur 25 of the time. With this position frame we can now produce an 3D scatter chart showing the candidates in our region of space. ", "id": "solorzano/dysonian-seti-with-machine-learning", "size": "19061", "language": "python", "html_url": "https://www.kaggle.com/code/solorzano/dysonian-seti-with-machine-learning", "git_url": "https://www.kaggle.com/code/solorzano/dysonian-seti-with-machine-learning", "script": "linear_model color_value sc extract_blend_vars get_abs_error_label plot_pos_frame cm transform_init extract_model_vars xgboost get_error_trainer RandomForestRegressor numpy transform_anomaly plotly.plotly save_data plt_hist separation_y get_blend_transform get_nn_trainer _transform sklearn.neural_network get_position_frame sklearn KFold matplotlib.pyplot get_gbm_trainer extract_error_vars plotly.offline plotly.graph_objs pandas sklearn.model_selection error transform_error get_nn_transform MLPRegressor get_gbm2_transform mean_squared_error scipy.stats matplotlib pd_concat get_gbm_transform get_blend_trainer get_gbm2_trainer print_evaluation combined_transform get_cv_model_transform sklearn.metrics sklearn.ensemble StandardScaler abs_mag_value sklearn.preprocessing ", "entities": "(('Distance modulus errors', 'scaling'), 'be') (('We', 'BP'), 'use') (('We', 'dashed blue line'), 'split') (('Defining', 'threshold'), 'be') (('a few anomalously dim that', 'slightly main sequence'), 'subsetsIn') (('Boilerplate code DataData', 'RAVE project https www'), 'obtain') (('s', 'only bright controls'), 'let') (('First s', 'data'), 'let') (('that', 'just one later analysis'), 'be') (('we', 'Gaia DR2'), 'note') (('don systematic', 'observed clustering'), 'believe') (('extinction interstellar irregularities galactic latitude', 'model'), 'be') (('bright controls', 'only slightly farther away 5'), 'be') (('We', 'mathematically conjecture'), 'test') (('only all', 'work data frame'), 'let') (('that', 'absolute residual meta model'), 'discover') (('possibility', 'contamination'), 'study') (('We', 'blend model'), 'use') (('t', 'available us'), 'explain') (('We', 'xgboost https xgboost'), 'use') (('Anomalously dim candidates green dots', 'it'), 'occur') (('reader', 'RP magnitudes'), 'change') (('that', 'main sequence'), 'csv') (('why we', 'variables'), 's') (('that', 'altered data'), 'create') (('We', 'therefore null hypothesis'), 'reject') (('previously we', 'work_data frame'), 'outline') (('that', 'modeled anomaly'), 'have') (('s', 'bright controls'), 'let') (('we', 'regression models'), 'define') (('that', 'blend'), 'create') (('model final blend', 'slightly different hyperparameters'), 'train') (('that', 'model still error'), 'be') (('these', 'parallax high error'), 'find') (('blend', '0'), 'produce') (('AcknowledgmentsThis work', 'European Space Agency ESA mission Gaia https www'), 'make') (('that', 'parallax distances'), 'suggest') (('that', 'main sequence'), 'be') (('following code', 'first 5 rows'), 'test') (('candidates', 'also likelihood'), 'affect') (('Final transformation', 'list'), 'put') (('Candidates', 'blue'), 'show') (('that', 'absolute residual meta model'), 'define') (('we', 'anomalously dim candidates'), 'use') (('clustering more robust test', 'ML Squared Residual Meta Model https www'), 'present') (('It', 'therefore probable color'), 's') (('new frame', 'distance'), 'order') (('We', 'giants'), 'add') (('We', 'entire dataset'), 'apply') (('orange dashed line', 'hypothesis expected null frequency'), 'show') (('23 when we', '2'), 'magnitude') (('which', 'different photometric filters'), 'use') (('that', 'case'), 'have') (('that', 'next'), 'be') (('Two additional lines', 'confidence 95 red 99 blue intervals'), 'show') (('transform following function', 'residual'), 'add') (('that', 'complex nonlinearities'), 'test') (('DiscussionWe', 'databases'), 'produce') (('we', 'case'), 'be') (('variables', 'model meta performance'), 'keep') (('that', 'always positive responses'), 'want') (('s', 'anomalously bright controls'), 'let') (('we', 'stars'), 'model') (('we', 'cross fold validation'), 'be') (('we', 'Gaia DR2'), 'take') (('We', 'expected absolute residual'), 'train') (('all', 'above'), 'note') (('that', 'Earth'), 'be') (('We', 'ordinary controls'), 'get') (('Funding', 'Gaia Multilateral Agreement'), 'provide') (('it', 'generally more less long individual models'), 'be') (('We', 'interstellar extinction'), 'like') (('where sources', 'rows'), 're') (('Model', 'model results'), 'look') (('that', 'somewhat problem'), 's') (('that', 'artificial megastructures'), 'of') (('Interstellar extinction', 'magnitude absolute estimate'), 'neglect') (('that', 'Gaia DR2'), 'add') (('Clustering', '3D chart'), 'appear') (('that', 'regression arbitrary model'), 'need') (('Theoretically difference', 'distance'), 'be') (('test data', 'that'), 'let') (('that', 'converts z distance galactic coordinates'), 'define') (('we', 'anything'), 'be') (('which', 'simply individual models'), 'need') (('it', 'model responses'), 'be') (('entirely it', 'region dependent patterns'), 'take') (('anomalously bright sources', 'Gaia'), 'be') (('they', 'other models'), 'be') (('we', 'magnitude features'), 'note') (('Anomalously dim candidates', 'kernel'), 'select') (('we', 'what'), 'produce') (('that', 'stars'), 'let') (('_ Radial Velocity Experiment', 'Fifth Data Release _'), 'RAVE') (('that', 'distance'), 'build') (('We', 'candidates'), 'square') (('we', 'cross distance entire frame'), 'be') (('random seed', 'clustering analysis'), 'change') (('RMSE', 'Gaia parallax'), 'be') (('blend', 'only slightly best individual model'), 'be') (('SynopsisWe', 'Zackrisson et al'), 'test') (('we', 'space'), 'produce') (('we', 'now 4 individual models'), 'blend') (('GR', 'below special variable'), 'be') (('that', 'training'), 'be') (('hypothesis', 'variables'), 'discard') (('that', 'relatively close Earth'), 'find') (('abs_mag_value function', 'absolute magnitude'), 'convert') (('why galactic latitude', 'precisely observed clustering'), 'be') (('better approximation', 'absolute magnitude'), 'derive') (('that', 'fit function'), 'take') (('set', 'green'), 'show') (('it', 'magnitude'), 'win') (('set', 'orange'), 'show') (('True True rows', '25 time'), 'be') (('dataset', 'Gaia DR2 APASS DR9 ALLWISE'), 'in') (('It', 'expected error'), 'seem') (('we', 'variables'), 'include') (('we', 'test data'), 'be') (('we', 'error significant regional patterns'), 'find') (('extinction additional that', 'roughly distance'), 's') (('First we', 'Gradient Boosting Machine GBM'), 'GBM') (('s', 'subsets'), 'let') (('that', 'array absolute residual i.'), 'define') (('we', 'candidates'), 'start') (('that', 'frame columns two e.'), 'define') (('bright that', 'sky'), 'be') (('error how distribution', 'normal distribution'), 'be') (('metallicity that', 'metal also abundance'), 'provide') (('s', 'concatenated frame'), 'let') (('transform', 'frame'), 'add') (('that', 'training'), 'csv') (('so long response', 'bag'), 's') (('we', 'test data'), 'create') (('sometimes as well most', 'main sequence'), 'be') (('This', 'work_data'), 'be') (('which', 'model performance'), 'have') (('error regional patters', 'residual model'), 'find') (('com solorzano dysonian seti', 'model New Stellar Magnitude Model https residual meta www'), 'square') (('Modeling', 'step'), 'consist') (('region', 'extinction'), 'include') (('each', 'pair'), 'add') (('residuals', 'model'), 'have') (('So we', 'sigma 3 level'), 'have') (('which', 'Gaia parallax'), 'magnitude') (('us', 'potentially valid candidates'), 'explore') (('spectral characteristics', 'other words'), 'be') (('more we', 'latitude features'), 'be') (('Rave', 'distance based modulus'), 'compare') (('First s', 'modeled absolute magnitude'), 'let') (('world real data', 'normal distribution'), 'be') (('seti candidate selection IntroductionDysonian stellar 1 SETI', 'civilizations Bradbury et extraterrestrial al'), 'be') (('where row', 'sources'), 'create') (('We', 'anomalously dim candidates'), 'find') (('it', 'stellar clustering'), 'note') (('which', 'separation_y function'), 'define') (('Specifically we', 'Gradient Boosting Machines GBMs'), 'blend') (('distance Spectrophotometic errorLet', 'Root Squared Error reference'), 'calculate') (('we', 'analyses'), 'want') (('Output filesThe following files', 'kernel'), 'make') "}