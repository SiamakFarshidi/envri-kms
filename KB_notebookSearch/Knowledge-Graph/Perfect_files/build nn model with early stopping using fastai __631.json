{"name": "build nn model with early stopping using fastai ", "full_name": " h1 Drop col h1 Add sentiment score to df h1 TfIdf on description h1 Image metadata h1 Start fastai nn process h1 Start training fastai NN h2 finetune ", "stargazers_count": 0, "forks_count": 0, "description": "Based on Eric s notebook https www. items new_coeff test_preds Store predictions for Kaggle Submission. com myltykritik simple lgbm image features The following 3 functions have been taken from Ben Hamner s github repository https github. plot_losses TODO need a better way to find these numbers new_coeff 1. explained_variance_ratio_ from fastai. plot_losses coeff 1. 06 _ evaluate_classification val_preds data. n_classes w w torch. sum k torch. sum dim 1 expected torch. transpose 0 1 2 sum0 self. 16 coeff 2 coeff 3 0. py def on_epoch_end self kwargs w torch. com skooch petfinder simple lgbm baseline of turning this into a regression problem with OptimizedRounder to further finetune predictions. einsum i j ij sum0 sum1 sum0. com benhamner Metrics def get_learner data layers save_name best_nn return tabular_learner data layers layers metrics accuracy callback_fns partial SaveModelCallback monitor val_loss name save_name def get_learner_no_cb data layers return tabular_learner data layers layers metrics accuracy QuadraticKappaScore class QuadraticKappaScore ConfusionMatrix Compute the rate of agreement Cohens Kappa. items coeff learn get_learner data layers model_name 2 learn. FROM https www. I haven t done much hyperparameters tuning so feel free to do so. tabular module to build a simple baseline neural net with 2 hidden layers feature embeddings 1cycle LR you can switch to constant LR if you want and SaveModelCallback to save best models during training. com scikit learn scikit learn blob bac89c2 sklearn metrics classification. 07 _ evaluate_classification val_preds data. collect_env import show_install learn get_learner data layers model_name 1 learn. explained_variance_ratio_. sum w expected self. float32 w w w. fit_one_cycle 5 max_lr 3e 05 learn. Drop col Add sentiment score to df TfIdf on description Image metadata Start fastai nn process Start training fastai NN finetune Any results you write to the current directory are saved as output. sum dim 0 sum1 self. load model_name 1 learn. fit_one_cycle 6 1e 01 pct_start 0. metric 1 k Fit TFIDF print svd. ", "id": "anhquan0412/build-nn-model-with-early-stopping-using-fastai", "size": "631", "language": "python", "html_url": "https://www.kaggle.com/code/anhquan0412/build-nn-model-with-early-stopping-using-fastai", "git_url": "https://www.kaggle.com/code/anhquan0412/build-nn-model-with-early-stopping-using-fastai", "script": "math Counter coefficients OptimizedRounder(object) cohen_kappa_score get_databunch predict confusion_matrix get_learner functools numpy accuracy_score TfidfVectorizer plot_pred on_epoch_end fastai.utils.collect_env sklearn.feature_extraction.text _kappa_loss metric histogram scipy confusion_matrix as sk_cmatrix StratifiedKFold fastai.callbacks.tracker QuadraticKappaScore(ConfusionMatrix) sklearn.model_selection evaluate_classification partial TruncatedSVD get_learner_no_cb fit mean_squared_error __init__ quadratic_weighted_kappa fastai.tabular rmse sklearn.decomposition sqrt sklearn.metrics collections ", "entities": "(('you', 'training'), 'feature') (('val_loss get_learner_no_cb data callback_fns partial SaveModelCallback save_name def layers', 'agreement Cohens Kappa'), 'return') (('I', 'so feel'), 'do') (('following 3 functions', 'Ben repository https github github'), 'feature') (('collect_env import show_install', 'get_learner data layers'), 'learn') (('model_name', 'get_learner data layers'), 'learn') (('plot_losses TODO', 'numbers'), 'need') (('scikit', 'sklearn metrics classification'), 'learn') (('you', 'output'), 'score') "}