{"name": "fastai v3 lesson 2 ", "full_name": " h3 Note The nb displays an error since the num of files downloaded limit imposed by kaggle If you fork and run the nb cell by cell it should run normally you will have to uncomment each line of code h1 Creating your own dataset from Google Images h2 Get a list of URLs h2 View data h2 Interpretation h2 Cleaning Up h2 Putting your model in production h2 Things that can go wrong h3 Learning rate LR too low h3 Too few epochs h3 Too many epochs ", "stargazers_count": 0, "forks_count": 0, "description": "Then click Next Batch to delete flagged photos and keep the rest in that row. Note Please Set the Number of images to a number that you d like to view ex n_imgs 100 Flag photos for deletion by clicking Delete. If you don t have a GPU that happens automatically. All the images you scrolled past are now available to download. First we need to get the file paths from our top_losses. ai t lesson 2 further discussion 28706 Note This is a mirror of the FastAI Lesson 2 Nb. You can test your model on CPU like so So you might create a route something like this thanks https github. ai t lesson 2 chat 28722 Further discussion thread https forums. You will need to get the urls of each of the images. ai Note The nb displays an error since the num of files downloaded limit imposed by kaggle. Too few epochs Too many epochs. Inspired by Adrian Rosebrock https www. csv from where you can create a new ImageDataBunch with the corrected labels to continue training your model. open data text csv charset utf 8 escape urls. com 2017 12 04 how to create a deep learning dataset using google images Get a list of URLs Search and scroll Go to Google Images and search for the images you are interested in. Note You can download the urls locally and upload them to kaggle using Here I have uploaded the urls for Teddy Grizzly Black Then we can remove any images that can t be opened View data Interpretation Cleaning UpSome of our top losses aren t due to bad performance by our model. There are images in our data set that shouldn t be. The API works in a similar way as with misclassified images just choose the ones you want to delete and click Next Batch until there are no more images left. predict img return JSONResponse predictions sorted zip cat_learner. You can do this by running the following commands urls Array. Lesson Video Link https course. route classify url methods GET async def classify_url request bytes await get_bytes request. Download into file Now you must run some Javascript code in your browser which will save the URLs of all the images you want for you dataset. ai for creating these I ve merely created a mirror of the same hereFor complete info on the course visit course. We can do this with. That is where you will paste the JavaScript commands. Notice that the widget will not delete images directly from disk but it will create a new csv file cleaned. Scroll down until you ve seen all the images you want to download or until you see a button that says Show more results. from_similars to get the potential duplicates ids and then run ImageCleaner with duplicates True. csv to include the changes you made in your data Putting your model in production You probably want to use CPU for inference except at massive scale and you almost certainly don t need to train in real time. We then feed the top losses indexes and corresponding dataset to ImageCleaner. ai t lesson 2 official resources and updates 28630 Lesson chat https forums. In this case the widget will show you images until there are none left from top_losses. ai videos lesson 2 Lesson resources and updates https forums. The maximum number of images Google Images shows is 700. classes map float losses key lambda p p 1 reverse True This example https www. Things that can go wrong Most of the time things will train fine with the defaults There s not much you really need to tune despite what you ve heard Most likely are Learning rate Number of epochs Learning rate LR too lowAs well as taking a really long time it s getting too many looks at each image so may overfit. The more specific you are in your Google Search the better the results and the less manual pruning you will have to do. com simonw cougar or not to Simon Willison for the structure of this code app. Remember to recreate your ImageDataBunch from your cleaned. It is a good idea to put things you want to exclude into the search query for instance if you are searching for the Eurasian wolf canis lupus lupus it might be a good idea to exclude other variants canis lupus lupus dog arctos familiaris baileyi occidentalisYou can also limit your results to show only photos by clicking on Tools and selecting Photos from the Type dropdown. Press CtrlShiftJ in Windows Linux and CmdOptJ in Mac and a small window the javascript Console will appear. ImageCleaner will show you a new row of images until there are no more to show. Using the ImageCleaner widget from fastai. join n Create directory and upload urls file into your server Choose an appropriate name for your labeled images. To get more click on the button and continue scrolling. Please uncomment the lines as you spot them Creating your own dataset from Google Images by Francisco Ingham and Jeremy Howard. query_params url img open_image BytesIO bytes _ _ losses learner. You can run these steps multiple times to grab different labels. If you fork and run the nb cell by cell it should run normally you will have to uncomment each line of codeNote A few lines have been commented out since it causes Commit Errors in kaggle The steps require manual correction of data which causes the kernel to stop running automatically. ImageCleaner ds idxs You can also find duplicates in your dataset and delete them To do this you need to run. widgets we can prune our top losses removing photos that don t belong. Please thank the amazing team behind fast. io is for the Starlette web app toolkit. ", "id": "init27/fastai-v3-lesson-2", "size": "5944", "language": "python", "html_url": "https://www.kaggle.com/code/init27/fastai-v3-lesson-2", "git_url": "https://www.kaggle.com/code/init27/fastai-v3-lesson-2", "script": "fastai.widgets fastai fastai.vision ", "entities": "(('You', 'commands urls following Array'), 'do') (('t 2 further 28706 This', 'FastAI Lesson'), 'ai') (('num', 'kaggle'), 'ai') (('t', 'data'), 'be') (('that', 'GPU'), 'have') (('you', 'Delete'), 'note') (('corrected labels', 'model'), 'csv') (('join n Create directory', 'labeled images'), 'choose') (('you', 'images'), 'download') (('kernel', 'data'), 'run') (('widget', 'top_losses'), 'show') (('You', 'multiple times different labels'), 'run') (('route classify url methods', 'get_bytes request'), 'get') (('don t', 'photos'), 'widget') (('ImageCleaner', 'images'), 'show') (('classes', 'float losses'), 'map') (('I', 'course visit course'), 'ai') (('img return JSONResponse predictions', 'zip cat_learner'), 'predict') (('that', 'more results'), 'scroll') (('First we', 'top_losses'), 'need') (('potential', 'duplicates True'), 'from_similar') (('you', 'Next Batch'), 'work') (('it', 'image'), 'train') (('you', 'images'), 'com') (('t', 'model'), 'note') (('you', 'Francisco Ingham'), 'uncomment') (('We', 'ImageCleaner'), 'feed') (('you', 'this'), 'idx') (('Google Images', 'images'), 'show') (('the better results less you', 'Google Search'), 'have') (('javascript small Console', 'Mac'), 'appear') (('data text open csv', 'escape utf 8 urls'), 'charset') (('canis lupus lupus dog arctos familiaris baileyi occidentalisYou', 'Type dropdown'), 'be') (('don almost certainly t', 'real time'), 'csv') (('it', 'csv new file'), 'notice') (('You', 'images'), 'need') (('where you', 'JavaScript commands'), 'be') (('So you', 'https github'), 'test') "}