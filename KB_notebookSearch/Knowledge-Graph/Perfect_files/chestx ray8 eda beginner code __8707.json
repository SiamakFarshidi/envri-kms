{"name": "chestx ray8 eda beginner code ", "full_name": " h1 1 NIH Chest X ray Dataset h2 National Institutes of Health Chest X Ray Dataset h2 1 2 Data limitations h3 File contents h3 BBoxlist2017 csv Bounding box coordinates Note Start at x y extend horizontally w pixels and vertically h pixels h3 Dataentry2017 csv Class labels and patient data for the entire dataset h3 1 3 Class descriptions h2 1 4 Special Remarks h3 In order to use the images for a classification task I converted the metadata file Data Entry 2017 csv and converted it into a one hot vector encoding for using in classification problem here h1 2 Loading Data h2 2 1 Loading Libraries h2 2 2 Loading DataFrames h2 2 3 Removing Samples with Bad Labels h3 2 4 Preparing Images h3 2 5 Creating Data Generator h3 2 6 Look at the X rays h3 2 7 Diagnosis Distribution Normal vs Sick h3 2 8 Diagnosis Distribution h3 2 9 Age Histogram Distribution ", "stargazers_count": 0, "forks_count": 0, "description": "This class also provides support for basic data augmentation such as random horizontal flipping of images. Therefore they are removed. gov was the largest publicly available source of chest X ray images with 4 143 images available. Parties who use this public dataset are encouraged to share their updated image labels and or new bounding boxes in their own studied later maybe through manual annotation File contentsImage format 112 120 total images with size 1024 x 1024 images_001. zip Contains 10 000 images images_006. zip Contains 10 000 images images_011. NIH Chest X ray Dataset 1 1 1. Wang et al https www. They are simply the x rays of healthy people marked as No Finding in the data frame. 28 only among the sick patients. NIH Chest X ray Dataset National Institutes of Health Chest X Ray DatasetChest X ray exams are one of the most frequent and cost effective medical imaging examinations available. Then I had a look at the metadata checking the Patient Age has some unusually high numbers. jpg filepaths Merge the absolute path of the images to the main dataframe BATCH_SIZE 8 strategy. 8 Diagnosis DistributionNow lets have a look at the distribution of the dataset. The generator also converts our single channel X ray images gray scale to a three channel format by repeating the values in the image across all channels. One major hurdle in creating large X ray image datasets is the lack resources for labeling so many images. The mean and standard deviation of the data is normalized3. The input is shuffled after each epoch. The lack of large publicly available datasets with annotations means it is still very difficult if not impossible to achieve clinically relevant computer aided detection and diagnosis CAD in real world medical sites with chest X rays. 5 Creating Data GeneratorBefore we create the training data generator from the keras built in library we can set several parameters. The labels are expected to be 90 accurate and suitable for weakly supervised learning. 2 Data Limitations 1 2 1. 3 Removing Samples with Bad LabelsYou oboserve that in main dataset Data_Entry_2017. We will want this because the pre trained model that we ll use requires three channel inputs. zip Contains 10 000 images images_007. zip Contains 10 000 images images_012. csv contains only 111863 images. 3 Class descriptionsThere are 15 classes 14 diseases and one for No findings. Prior to the release of this dataset Openi https openi. 4 Special Remarks In order to use the images for a classification task I converted the metadata file Data_Entry_2017. histogram I was getting unusually high range. 9 Age Histogram DistributionLooking at the dataframe from the metadata I found something interesting. zip Contains 4999 images images_002. Note Start at x y extend horizontally w pixels and vertically h pixelsImage Index File nameFinding Label Disease type Class label Bbox xBbox yBbox wBbox h Dataentry2017. zip Contains 10 000 images images_008. gov news events news releases nih clinical center provides one largest publicly available chest x ray datasets scientific community 1. For this the off the shelf ImageDataGenerator https keras. 1 Loading Libraries 2. You can run the following cell multiple times to get more images. csv contains 112120 rows but in modified dataset train_df. 2 Loading DataFrames 2 2 1. zip Contains 10 000 images images_009. 4 Special Remarks 1 4 2. However the hightest prevalance Infiltration has only 25 and rest of the 13 classses combines to the rest. zip Contains 10 000 images images_003. Images can be classified as No findings or one or more disease classes Atelectasis Consolidation Infiltration Pneumothorax Edema Emphysema Fibrosis Effusion Pneumonia Pleural_thickening Cardiomegaly Nodule Mass Hernia 1. csv and converted it into a one hot vector encoding for using in classification problem here https www. pdf Original README file BBoxlist2017. We also use the generator to transform the values in each batch so that their mean is 0 and their standard deviation is 1. So we need to do a little bit of peprocessing here to deal with that matter and we are good to go. csv Bounding box coordinates. They are inverted not frontal or somehow badly rotated. To create these labels the authors used Natural Language Processing to text mine disease classifications from the associated radiological reports. Since it is mainly a matter of reading and understanding Keras documentation we have implemented the generator for you. This NIH Chest X ray Dataset is comprised of 112 120 X ray images with disease labels from 30 805 unique patients. zip Contains 10 000 images images_004. csv Chest x ray radiology reports are not anticipated to be publicly shared. csv Class labels and patient data for the entire datasetImage Index File nameFinding Labels Disease type Class label Follow up Patient IDPatient AgePatient GenderView Position X ray orientationOriginalImageWidthOriginalImageHeightOriginalImagePixelSpacing_xOriginalImagePixelSpacing_y 1. Very limited numbers of disease region bounding boxes See BBoxlist2017. 6 Look at the X raysNow lets have a look at the original dataset. 3 Class Description 1 3 1. You can play with the folowing parameters to see what changes. zip Contains 7 121 imagesREADME_ChestXray. 2 Data limitations The image labels are NLP extracted so there could be some erroneous labels but the NLP labeling accuracy is estimated to be 90. It turns out some of the images are problematic as discussed in this datasets discussion thread https www. 7 Diagnosis Distribution Normal vs Sick Now lets have a look at the distribution of the dataset. It is quire evident that almost half of the images didn t have any problem. Loading Data 2 1 2. There are a few things to note 1. However clinical diagnosis of a chest X ray can be challenging and sometimes more difficult than diagnosis via chest CT imaging. Just checked the patients with age greater than 100 and found out several patients samples where age is listed 140 year to even 450 years P P P Then I replaced those values with mean of the rest of the dataset which are less than 100 years old because they are simply data entry error. The default image size is selected as 320px by 320px but it can be changed. io preprocessing image class from the Keras framework which allows us to build a generator for images specified in a dataframe. At first try when I wanted to draw the histogram using np. So the dataset has highly imbalanced positive class which will in turn create problem of negative bias while training CNN models. zip Contains 10 000 images images_010. 4 Preparing ImagesWith our dataset splits ready we can now proceed with setting up our model to consume them. com redwankarimsony chestxray8 dataframe I also removed some of the images from the dataframe as those images were inverted rotated or not frontal view of the chest because they carry little or no information necesary for the classification problem. This will facilitate model training by standardizing the input distribution. com nih chest xrays data discussion 55461. Import necessary packages Listing all the. 1 Brief Overview 1 1 1. 2 Loading DataFrames 2. 1 Loading Libraries 2 1 2. num_replicas_in_sync normalize images flow from directory with specified batch size and target image size bokeh packages show diag_dist build histogram data with Numpy bokeh histogram with hover tool hover tool output. However we can have a look at the number of healthy and non healthy x rays. The original radiology reports are not publicly available but you can find more details on the labeling process in this Open Access paper ChestX ray8 Hospital scale Chest X ray Database and Benchmarks on Weakly Supervised Classification and Localization of Common Thorax Diseases. Here get_label function returns the concatenated version of the names of the diagnosis categories. zip Contains 10 000 images images_005. We observe that among the different identified conditions Infiltration Effusion and Atelectasis have the highest dominance and Hernia has the lowest prevalance. Hernia is very small 0. ", "id": "mohamed3abdelrazik/chestx-ray8-eda-beginner-code", "size": "8707", "language": "python", "html_url": "https://www.kaggle.com/code/mohamed3abdelrazik/chestx-ray8-eda-beginner-code", "git_url": "https://www.kaggle.com/code/mohamed3abdelrazik/chestx-ray8-eda-beginner-code", "script": "math bokeh.layouts join os IPython.display listdir show BuGn4 keras.preprocessing.image Image numpy LinearAxis seaborn isdir cumsum bokeh.models.tools output_file ImageDataGenerator glob Category20c get_train_generator os.path tqdm figure hist_hover cividis bokeh.transform bokeh.plotting matplotlib.pyplot column output_notebook PIL ColumnDataSource Range1d get_label pandas plot_pie_bokeh bokeh.models row pi Category20b isfile bokeh.palettes HoverTool ", "entities": "(('mean deviation', 'data'), 'be') (('Removing 3 Samples', 'main dataset'), 'oboserve') (('Diagnosis DistributionNow 8 lets', 'dataset'), 'have') (('One major hurdle', 'lack so many images'), 'be') (('less than 100 years they', 'dataset'), 'check') (('we', 'you'), 'implement') (('csv', 'modified dataset'), 'contain') (('Very limited numbers', 'BBoxlist2017'), 'see') (('This', 'input distribution'), 'facilitate') (('6 Look', 'original dataset'), 'have') (('I', 'something'), 'DistributionLooking') (('standard deviation', 'batch'), 'use') (('get_label Here function', 'diagnosis categories'), 'return') (('However clinical diagnosis', 'chest CT imaging'), 'challenge') (('it', '320px'), 'select') (('publicly you', 'Common Thorax Diseases'), 'be') (('However we', 'x healthy rays'), 'have') (('Class 3 descriptionsThere', '15 classes 14 findings'), 'be') (('You', 'multiple times more images'), 'run') (('highest dominance', 'lowest prevalance'), 'observe') (('when I', 'np'), 'at') (('jpg filepaths', 'main dataframe'), 'merge') (('They', 'data frame'), 'be') (('gov', '4 143 images'), 'be') (('dataset we', 'them'), 'split') (('NIH Chest X ray Dataset', '30 805 unique patients'), 'comprise') (('generator', 'channels'), 'convert') (('chest one largest publicly available ray', 'scientific community'), 'release') (('who', 'size'), 'encourage') (('Images', 'disease Atelectasis Consolidation Infiltration Pneumothorax Edema Emphysema Fibrosis Effusion Pneumonia Pleural_thickening Cardiomegaly Nodule Mass one Hernia'), 'classify') (('labels', 'accurate weakly supervised learning'), 'expect') (('class', 'images'), 'provide') (('I', 'metadata file'), 'Remarks') (('us', 'dataframe'), 'io') (('which', 'CNN models'), 'imbalance') (('almost half', 'didn problem'), 'be') (('some', 'discussion thread https www'), 'turn') (('Infiltration', 'rest'), 'have') (('Now lets', 'dataset'), 'normal') (('Chest X Ray DatasetChest X ray exams', 'imaging effective medical examinations'), 'be') (('we', 'several parameters'), '5') (('You', 'folowing parameters'), 'play') (('Then I', 'unusually high numbers'), 'have') (('we', 'here matter'), 'need') (('they', 'classification problem'), 'dataframe') (('we', 'channel three inputs'), 'want') (('target image size bokeh diag_dist', 'hover tool hover tool output'), 'show') (('histogram I', 'unusually high range'), 'get') (('it', 'chest X rays'), 'mean') "}