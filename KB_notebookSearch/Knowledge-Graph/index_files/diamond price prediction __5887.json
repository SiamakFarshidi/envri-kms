{"name": "diamond price prediction ", "full_name": " h1 Price Prediction Of Diamonds Regression h1 INDEX h1 LIBRARIES h1 LOADING DATA h2 DATA PREPROCESSING h1 MODEL BUILDING h1 FIN ", "stargazers_count": 0, "forks_count": 0, "description": "Fit all the models on training data Get mean of cross validation on the training set for all the models for negative root mean square error Pick the model with the best cross validation score Fit the best model on the training set and get Testing the Model with the best score on the test set In the above scores XGBClassifier appears to be the model with the best scoring on negative root mean square error. input directory For example running this by clicking run or pressing Shift Enter will list all files under the input directory You can write up to 20GB to the current directory kaggle working that gets preserved as output when you create a version using Save Run All You can also write temporary files to kaggle temp but they won t be saved outside of the current session All the libralies used in this project The first column seems to be just index Dropping dimentionless diamonds Let s have a look at data shades for hue I chose cut as hue. List of all the pipelines Dictionary of pipelines and model types for ease of reference Fit the pipelines Model prediction on test data Model Evaluation. Feature description price price in US dollars 326 18 823 This is the target column containing tags for the features. So we need to filter out those as it clearly faulty data points. Let s have a look at regression plots to get a close look at the outliers. We could consider dropping but let s keep it. The 4 Cs of Diamonds carat 0. Lable encoding the data to get rid of object dtype. Carat weight is the most objective grade of the 4Cs. DATA PREPROCESSING Data Preprocessing Steps involved in Data Preprocessing Data cleaning Identifying and removing outliers Encoding categorical variablesThe first column is an index Unnamed 0 and thus we are going to remove it. Dimensions x length in mm 0 10. If you have any suggestions or questions I am all ears Best Wishes FIN This Python 3 environment comes with many helpful analytics libraries installed It is defined by the kaggle python Docker image https github. If you liked this Notebook please do upvote. Now that we have removed regression outliers let us have a look at the pair plot of data in our hand. table width of the top of the diamond relative to widest point 43 95 A diamond s table refers to the flat facet of the diamond seen when the stone is face up. Let s test this model on a test set and evaluate it with different parameters. clarity I1 worst SI2 SI1 VS2 VS1 VVS2 VVS1 IF best Diamonds can have internal characteristics known as inclusions or external characteristics known as blemishes. DATA PREPROCESSING 3 4. png attachment diamands 20project. FIN 5 LIBRARIES Importing LibrariesLOADING DATA Loading DataThis classic dataset contains the prices and other attributes of almost 54 000 diamonds. com kaggle docker python For example here s several helpful packages to load linear algebra data processing CSV file I O e. Diamonds without inclusions or blemishes are rare however most characteristics can only be seen with magnification. IMPORTING LIBRARIES 1 2. In the range from colourless to light yellow or light brown. png depth total depth percentage z mean x y 2 z x y 43 79 The depth of the diamond is its height in millimetres measured from the culet bottom tip to the table flat top surface. We can also examine other attributes in hue with less value count. Get list of categorical variables Make copy to avoid changing original data Apply label encoder to each column with categorical data correlation matrix Assigning the featurs as X and trarget as y Building pipelins of standard scaler and model for varios regressors. 01 The carat is the diamond s physical weight measured in metric carats. The ideal table cut diamond will give the diamond stunning fire and brilliance. MODEL BUILDING 4 5. The table featured should be capped too. color from J worst to D best The colour of gem quality diamonds occurs in many hues. 74 y width in mm 0 58. Pairplot Of Data A few points to notice in these pair plots There are some features with datapoint that are far from the rest of the dataset which will affect the outcome of our regression model. The depth should be capped but we must examine the regression line to be sure. 9 z depth in mm 0 31. One carat equals 1 5 gram and is subdivided into 100 points. Next up we will remove these data points. We have three categorical variables. That s a much cleaner dataset. MODEL BUILDING Model Building Steps involved in Model Building Setting up features and target Build a pipeline of standard scalar and model for five different regressors. y and z have some dimensional outlies in our dataset that needs to be eliminated. The main purpose of a diamond table is to refract entering light rays and allow reflected light rays from within the diamond to meet the observer s eye. We can clearly spot outliers in these attributes. Price Prediction Of Diamonds Regression diamands 20project. We lost 20 data points by deleting the dimensionless 2 D or 1 D diamonds. Let us have a look at them. There are 10 attributes included in the dataset including the target ie. Colourless diamonds are the rarest. read_csv Input data files are available in the read only. Points to notice Min value of x y z are zero this indicates that there are faulty values in data that represents dimensionless or 2 dimensional diamonds. depth cut and table show low correlation. LOADING DATA 2 3. The more precise the diamond is cut the more captivating the diamond is to the eye. Dropping the outliers. 8 diamands 20project 20 281 29. We can clearly spot outliers in these attributes. Points to notice x y and z show a high correlation to the target column. Other natural colours blue red pink for example are known as fancy and their colour grading is different than from white colorless diamonds. Next we will deal with the categorical variables. png attachment diamands 20project 20 281 29. cut Fair Good Very Good Premium Ideal In determining the quality of the cut the diamond grader evaluates the cutter s skill in the fashioning of the diamond. ", "id": "karnikakapoor/diamond-price-prediction", "size": "5887", "language": "python", "html_url": "https://www.kaggle.com/code/karnikakapoor/diamond-price-prediction", "git_url": "https://www.kaggle.com/code/karnikakapoor/diamond-price-prediction", "script": "sklearn.metrics PCA cross_val_score sklearn.tree DecisionTreeRegressor KNeighborsRegressor mean_squared_error seaborn numpy sklearn.pipeline RandomForestRegressor matplotlib.pylab sklearn.decomposition sklearn.ensemble sklearn.model_selection sklearn metrics LabelEncoder XGBRegressor matplotlib.pyplot pandas Pipeline OneHotEncoder StandardScaler sklearn.neighbors sklearn.linear_model matplotlib sklearn.preprocessing xgboost train_test_split LinearRegression ", "entities": "(('s', 'outliers'), 'let') (('Carat weight', 'most objective 4Cs'), 'be') (('326 18 This', 'features'), 'price') (('you', 'upvote'), 'do') (('I', 'hue'), 'list') (('clarity SI2 SI1 VS2 VS1 VVS2 worst best Diamonds', 'external blemishes'), 'I1') (('cut diamond', 'stunning fire'), 'give') (('best colour', 'many hues'), 'color') (('depth cut', 'low correlation'), 'show') (('We', 'attributes'), 'spot') (('however most characteristics', 'only magnification'), 'be') (('carat', 'physical metric carats'), '01') (('s', 'it'), 'consider') (('that', 'dataset'), 'y') (('depth', 'table flat top surface'), 'percentage') (('Points', 'target column'), 'show') (('Importing Loading FIN 5 DataThis classic dataset', '54 other almost 000 diamonds'), 'datum') (('us', 'hand'), 'let') (('diamond grader', 'diamond'), 'cut') (('more diamond', 'eye'), 'cut') (('best model', 'negative root'), 'fit') (('Price Prediction', '20project'), 'diamand') (('it', 'those'), 'need') (('which', 'regression model'), 'point') (('Unnamed 0 thus we', 'it'), 'be') (('read_csv Input data files', 'read'), 'be') (('s', 'different parameters'), 'let') (('main purpose', 'eye'), 'be') (('when stone', 'diamond'), 'width') (('It', 'kaggle python Docker image https github'), 'be') (('that', 'dimensionless'), 'point') (('We', 'value less count'), 'examine') (('colour fancy grading', 'colorless white diamonds'), 'know') (('Next we', 'categorical variables'), 'deal') (('We', 'dimensionless 2 D'), 'lose') (('One carat', '100 points'), 'equal') (('Next up we', 'data points'), 'remove') ", "extra": "['outcome', 'test']"}