{"name": "panda eda better visualization simple baseline ", "full_name": " h2 About this notebook h1 1 Dive deep into domain knowledge h3 Q1 What is Prostate Cancer h3 Q2 How it is tested and detected h3 Q3 Where does GLEASON score fit in all of this h3 Q4 I got it but What is ISUP grade now h3 Q5 How has the Gleason scores been generated in the dataset h1 2 Getting started with the PANDA dataset h2 3 Loading Dataset h3 Output Variables h3 Note There are no test images publically available h2 4 Basic EDA h3 4 1 Checking for data provider distribution h3 4 2 Checking for isup grade distribution h3 4 3 Checking for gleason score distribution h3 4 4 Let s check for relative distribution of isup grade and data provider h3 4 5 Let s check for relative distribution of gleason score and data provider h3 4 6 Let s check for relative distribution of isup grade and gleason score h2 5 Quickly displaying few images h2 6 Loading label masks h3 Visualizing masks using matplotlib h3 Displaying images and masks for each isup grade category h2 Overlaying masks on the slides h2 Exploring images with pen markers h2 Simple Baseline h3 Ending note Please upvote this kernel if you like it It motivates me to produce more quality content ", "stargazers_count": 0, "forks_count": 0, "description": "On the other hand radbound is major data provider for 4 4 4 3 4 5 5 4 5 5 5 3 3 5. ASAP can also overlay the masks on top of the images using the Overlay functionality. These markings are not part of the tissue but were made by the pathologists who originally checked this case. Each epithelial unit is separate and has a lumen. Simple BaselineRefrence to my other works for this competition https www. The label information is stored in the red R channel the other channels are set to zero and can be ignored. The dataset consists of around 11. Let s take a look on few of these images. com rohitsingh9990 panda resize and save image mask overlay notebook scriptVersionId 32614926 https www. 5 Let s check for relative distribution of gleason_score and data_provider inference In gleason_score category 0 0 all the data is provided by karolinska. An alternate cancer severity rating system with more levels than the ISUP scale. The probe uses sound waves to create a picture of your prostate gland. D Prostatic adenocarcinoma Gleason Pattern 5 has an almost complete loss of glandular differentiation. This microphotograph shows irregular cribriform cancer i. Exploring images with pen markersIt is mentioned here https www. com gpreda panda challenge starting eda https www. This is a standard way of staining the originally transparent tissue to produce some contrast. C Prostatic adenocarcinoma Gleason Pattern 4 has partial loss of glandular differentiation. com c prostate cancer grade assessment data that in training dataset there are few images with pen markers on them. A laboratory pathologist examines a sample of your cancer to determine how much cancer cells differ from the healthy cells. All microphotographs show hematoxylin and eosin stains at 20x lens magnification. Dataset is not balanced in terms of gleason_score. epithelial sheets with multiple lumina. Collecting a sample of prostate tissue If initial test results suggest prostate cancer your doctor may recommend a procedure to collect a sample of cells from your prostate prostate biopsy. There are also some poorly formed small glands and some fused glands. These pen markings are available on some slides in the training set. The glands are grouped together. Prostate specific antigen PSA test A blood sample is drawn from a vein in your arm and analyzed for PSA a substance that s naturally produced by your prostate gland. Want to interactively view a slide We have added an interactive viewer Interactive viewer for slides to this notebook in the last section. Rest of the data samples have associated ISUP grades from 2 to 5 with all ranging in the 11 12 each. Intermediate levels can be created by downsampling a higher resolution level. The severity of the cancer on a 0 5 scale. Note that slightly different procedures were in place for the images used in the test set than the training set. This kernel will be a work in Progress and I will keep on updating it as the competition progresses If you find this kernel useful Please consider Upvoting it it motivates me to write more Quality content 1. If a DRE or PSA test detects an abnormality your doctor may recommend further tests to determine whether you have prostate cancer such as Ultrasound If other tests raise concerns your doctor may use transrectal ultrasound to further evaluate your prostate. com c prostate cancer grade assessment discussion 145850 Help taken from following kernel https www. The grading system recognizes three categories 3 4 and 5. For details on how the gleason and ISUP systems compare see the Additional Resources tab. This rotation has no clinical value and is only dependent on how the biopsy was collected in the lab. All exams with ISUP grade 5 have Gleason score 4 5 majority 5 4 or 5 5. Valid values 0 background non tissue or unknown 1 benign tissue stroma and epithelium combined 2 cancerous tissue stroma and epithelium combined The label masks of Radboudumc were semi automatically generated by several deep learning algorithms contain noise and can be considered as weakly supervised labels. To do this we load both the mask and the biopsy and merge them using PIL. Small glands infiltrate between benign glands. Quickly displaying few imagesIn the following sections we will load data from the slides with OpenSlide https openslide. 000 whole slide images WSI of prostate biopsies from Radboud University Medical Center and the Karolinska Institute. Q5 How has the Gleason scores been generated in the dataset Each WSI in this challenge contains one or in some cases two thin tissue sections cut from a single biopsy sample. The most common scale used to evaluate the grade of prostate cancer cells is called a Gleason score. All exams with ISUP grade 1 have Gleason score 3 3. 3 Checking for gleason_score distribution inference From above graph it is clear that gleason_score distribution is not uniform. 4 Let s check for relative distribution of isup_grade and data_provider inference In isup_grade category 0 and 1 most of the data is provided by karolinska. Visualizing masks using matplotlib Given that the masks are just integer matrices you can also use other packages to display the masks. Tip Want to view the slides in a more interactive way Using a WSI viewer you can interactively view the slides. com c prostate cancer grade assessment discussion 145574 discussion thread it is clear that there are 100 images which do not have any mask in the mask directory. Usually prostate cancer grows slowly and is initially confined to the prostate gland where it may not cause serious harm. Note In the example below you can also observe a few pen markings on the slide dark green smudges. org api python Few Insights The image dimensions are quite large typically between 5. B Prostatic adenocarcinoma Gleason Pattern 3 has no loss of glandular differentiation. Gleason scoring combines two numbers and can range from 2 nonaggressive cancer to 10 very aggressive cancer though the lower part of the range isn t used as often. In isup_grade category 3 4 and 5 most of the data is provided by radbound. The benefit of OpenSlide is that we can load arbitrary regions of the slide without loading the whole image in memory. The tissue sample is analyzed in a lab to determine whether cancer cells are present. Gleason Pattern 5 may also contain solid sheets or strands of cancer cells. com rohitsingh9990 panda resnext inference ensemble lb 0 66 https www. 2 Checking for isup_grade distribution inference Majority of data samples in train set have ISUP grade values 0 or 1 total 50. All of these are included in Gleason Pattern 4. Biopsies can be in different rotations. Valid values are 0 background non tissue or unknown 1 stroma connective tissue non epithelium tissue 2 healthy benign epithelium 3 cancerous epithelium Gleason 3 4 cancerous epithelium Gleason 4 5 cancerous epithelium Gleason 5 Karolinska Regions are labelled. com tanulsingh077 prostate cancer in depth understanding eda modelmore to come will update soon Ending note Please upvote this kernel if you like it. However if a higher than normal level is found it may indicate prostate infection inflammation enlargement or cancer. 1 Checking for data provider distribution 4. If you use Qupath and the images do not load try changing the file extension to. Each slide has 3 levels you can load corresponding to a downsampling of 1 4 and 16. 000 pixels in both x and y. These masks directly indicate which parts of the tissue are healthy and which are cancerous. This overlay can help you identifying the different growth patterns. You can read more about the OpenSlide python bindings in the documentation https openslide. About this notebookIn this notebook I will start with complete explanation of everything you need know related to Prostate Cancer and its detection and I will built on that to explain the dataset and perform extensive EDA. Also in gleason_score category 3 3 karolinska is major data provider. Loading label masksApart from the slide level label present in the csv file almost all slides in the training set have an associated mask with additional label information. Few gleason_score like 3 3 and 0 0 are more frequent while others like 3 5 and 5 3 are very rare in this dataset. com rohitsingh9990 panda resnext inference https www. 6 Let s check for relative distribution of isup_grade and gleason_score inference All exams with ISUP grade 0 have Gleason score 0 0 or negative. A Benign prostate glands with folded epithelium The cytoplasm is pale and the nuclei small and regular. The appearance of the glands forms the basis of the Gleason grading system. com kaggle media competitions PANDA Screen 20Shot 202020 04 08 20at 202. gleason_score Train only. All exams with ISUP grade 2 have Gleason score 3 4. Q4 I got it but What is ISUP grade now According to current guidelines by the International Society of Urological Pathology ISUP the Gleason scores are summarized into an ISUP grade on a scale from 1 to 5 according to the following rule Gleason score 6 ISUP grade 1 Gleason score 7 3 4 ISUP grade 2 Gleason score 7 4 3 ISUP grade 3 Gleason score 8 ISUP grade 4 Gleason score 9 10 ISUP grade 5 If there is no cancer in the sample we use the label ISUP grade 0 in this competition. Q3 Where does GLEASON score fit in all of this When a biopsy confirms the presence of cancer the next step is to determine the level of aggressiveness grade of the cancer cells. In gleason_score category negative all the data is provided by radbound. A small probe about the size and shape of a cigar is inserted into your rectum. The samples are made up of glandular tissue and connective tissue. As with the slides itself the label masks can be opened using OpenSlide. A higher grade indicates a more aggressive cancer that is more likely to spread quickly. Q2 How it is tested and detected Prostate screening tests might include Digital rectal exam DRE During a DRE your doctor inserts a gloved lubricated finger into your rectum to examine your prostate which is adjacent to the rectum. All exams with ISUP grade 3 have Gleason score 4 3. The label masks of Karolinska were semi autotomatically generated based on annotations by a pathologist. The cytoplasm is often dark and the nuclei enlarged with dark chromatin and some prominent nucleoli. Prior to scanning the tissue is stained with haematoxylin eosin H E. There is an attempt to form lumina but the tumor fails to form complete well developed glands. Getting started with the PANDA datasetThis notebook shows a few methods to load and display images from the PANDA challenge dataset. Dataset is not balanced in terms of isup_grade. The information in the masks differ from the two centers Radboudumc Prostate glands are individually labelled. Prostate biopsy is often done using a thin needle that s inserted into the prostate to collect tissue. All exams with ISUP grade 4 have Gleason score 4 4 majority 3 5 or 5 3. The glandular structure characteristic of healthy prostate tissue is progressively lost with increasing grade. Loading Dataset Output Variables isup_grade The target variable. com iamleonie panda eda visualizations suspicious data Domain knowledge info taken from https www. However while some types of prostate cancer grow slowly and may need minimal or even no treatment other types are aggressive and can spread quickly. Some of the training set images have stray pen marks on them but the test set slides are free of pen marks. com computationalpathologygroup ASAP and QuPath https qupath. It motivates me to produce more quality content There are two ways to load the data from the PANDA dataset Option 1 Load images using openslide Option 2 Load images using skimage requires that tifffile is installed General packages Plotly for the interactive viewer see last section Location of the training images image and mask directories Location of training labels Create alpha mask Mapping 0 background 1 stroma 2 benign epithelium 3 Gleason 3 4 Gleason 4 5 Gleason 5 Mapping 0 background 1 benign 2 cancer. The label masks are stored in an RGB format so that they can be easily opened by image readers. If your doctor finds any abnormalities in the texture shape or size of the gland you may need further tests. Dive deep into domain knowledge So lets start with the domain knowledge and Address the first question Q1 What is Prostate Cancer Prostate cancer is cancer that occurs in the prostate a small walnut shaped gland in men that produces the seminal fluid that nourishes and transports sperm. Prostate cancer is one of the most common types of cancer in men. There are noticable color differences between the biopsies this is very common within pathology and is caused by different laboratory procedures. The glands are hollow structures which can be seen as white holes or branched cavities in the WSI. png Note There are no test images publically available. Examples of open source viewers that can open the PANDA dataset are ASAP https github. Dispersed single cancer cells are seen in the stroma. Overlaying masks on the slidesAs the masks have the same dimension as the slides we can overlay the masks on the tissue to directly see which areas are cancerous. The organizers left us with a Note as described below. The dimensions of each level differ based on the dimensions of the original image. For example using matplotlib and a custom color map we can quickly visualize the different cancer regions Displaying images and masks for each isup_grade categoryCheck for images without masks as from this https www. It s normal for a small amount of PSA to be in your bloodstream. ", "id": "rohitsingh9990/panda-eda-better-visualization-simple-baseline", "size": "14218", "language": "python", "html_url": "https://www.kaggle.com/code/rohitsingh9990/panda-eda-better-visualization-simple-baseline", "git_url": "https://www.kaggle.com/code/rohitsingh9990/panda-eda-better-visualization-simple-baseline", "script": "plot_relative_distribution display_images display plot_count load_and_resize_image overlay_mask_on_slide load_and_resize_mask seaborn numpy matplotlib.pyplot Image plotly.graph_objs pandas display_masks IPython.display ", "entities": "(('this', 'laboratory different procedures'), 'be') (('cancer how much cells', 'healthy cells'), 'examine') (('3 Gleason', '4 3'), 'score') (('structure glandular characteristic', 'progressively increasing grade'), 'lose') (('label masks', 'pathologist'), 'generate') (('which', 'rectum'), 'include') (('notebook', 'PANDA challenge dataset'), 'show') (('you', 'it'), 'update') (('cancer cells', 'lab'), 'analyze') (('Dataset', 'gleason_score'), 'balance') (('label masks', 'OpenSlide'), 'open') (('almost all slides', 'label additional information'), 'have') (('information', 'centers Radboudumc Prostate two glands'), 'label') (('2 Gleason', '3 4'), 'score') (('s', 'images'), 'let') (('mask Location', '3 3 4 4 5 Gleason 5 Mapping 0 background 1 benign 2 cancer'), 'motivate') (('organizers', 'Note'), 'leave') (('you', '1 4'), 'have') (('you', 'interactively slides'), 'want') (('small probe', 'rectum'), 'insert') (('cytoplasm', 'often dark chromatin'), 'be') (('other channels', 'zero'), 'store') (('100 which', 'mask directory'), 'prostate') (('which', 'tissue'), 'indicate') (('that', 'more aggressive cancer'), 'indicate') (('I', 'extensive EDA'), 'about') (('1 most', 'karolinska'), 'let') (('Dataset', 'isup_grade'), 'balance') (('doctor', 'further prostate'), 'detect') (('it', 'Quality more content'), 'be') (('we', 'OpenSlide https'), 'display') (('appearance', 'Gleason grading system'), 'form') (('who', 'originally case'), 'be') (('we', 'memory'), 'be') (('more others', '5 very dataset'), 'be') (('that', 'seminal fluid'), 'deep') (('how gleason', 'Additional Resources tab'), 'see') (('1 Gleason', '3 3'), 'score') (('directly areas', 'tissue'), 'overlay') (('0 0 data', 'karolinska'), 'let') (('custom color we', 'https www'), 'visualize') (('Exploring', 'pen markersIt'), 'mention') (('grading system', 'three categories'), 'recognize') (('5 Gleason', '4 5 majority'), 'score') (('epithelial unit', 'lumen'), 'be') (('slightly different procedures', 'training set'), 'note') (('that', 'PANDA dataset'), 'be') (('This', 'contrast'), 'be') (('hollow which', 'branched WSI'), 'be') (('data', 'radbound'), 'provide') (('all', '11 12'), 'associate') (('Intermediate levels', 'resolution higher level'), 'create') (('only how biopsy', 'lab'), 'have') (('you', 'further tests'), 'need') (('cytoplasm', 'prostate Benign folded epithelium'), 'gland') (('test set slides', 'pen marks'), 'have') (('microphotograph', 'cribriform cancer irregular i.'), 'show') (('microphotographs', '20x lens magnification'), 'show') (('s', 'ISUP grade'), 'let') (('tumor', 'complete well developed glands'), 'be') (('4 most', 'radbound'), 'provide') (('C Prostatic adenocarcinoma', 'glandular differentiation'), 'have') (('we', 'PIL'), 'load') (('You', 'documentation https'), 'read') (('tissue two thin sections', 'biopsy single sample'), 'Q5') (('next step', 'cancer cells'), 'score') (('doctor', 'prostate prostate biopsy'), 'recommend') (('probe', 'prostate gland'), 'use') (('3 Karolinska 2 healthy benign epithelium 3 cancerous epithelium 4 cancerous 4 5 cancerous Gleason 5 Regions', 'stroma 0 background non unknown 1 connective non epithelium tissue'), 'be') (('4 Gleason', '4 4 majority'), 'score') (('small amount', 'bloodstream'), 's') (('it', 'prostate infection inflammation enlargement'), 'find') (('cancer Dispersed single cells', 'stroma'), 'see') (('Small glands', 'benign glands'), 'infiltrate') (('you', 'growth different patterns'), 'help') (('tissue tissue label unknown 1 benign epithelium combined 2 cancerous masks', 'weakly supervised labels'), 'combine') (('3 3 karolinska', 'gleason_score Also category'), 'be') (('grade', 'prostate cancer cells'), 'call') (('We', 'last section'), 'want') (('com c prostate cancer grade assessment discussion', 'kernel https 145850 www'), 'help') (('D Prostatic adenocarcinoma', 'glandular differentiation'), 'have') (('B', 'glandular differentiation'), 'have') (('2 Checking', 'ISUP grade values'), 'have') (('ASAP', 'Overlay functionality'), 'overlay') (('we', '0 competition'), 'get') (('they', 'image easily readers'), 'store') (('that', 'naturally prostate gland'), 'test') (('even other types', 'slowly minimal'), 'be') (('All', 'Gleason Pattern'), 'include') (('integer just you', 'masks'), 'visualize') (('org api Few image dimensions', 'quite typically 5'), 'python') (('where it', 'serious harm'), 'grow') (('pen markings', 'training set'), 'be') (('samples', 'glandular tissue'), 'make') (('that', 'tissue'), 'do') (('gleason_score distribution', 'graph'), 'check') (('dimensions', 'original image'), 'differ') (('Gleason scoring', 'range isn t'), 'combine') (('Gleason Pattern', 'cancer cells'), 'contain') (('Prostate cancer', 'men'), 'be') (('images', 'file extension'), 'try') ", "extra": "['annotation', 'biopsy', 'biopsy of the greater curvature', 'test', 'procedure']", "label": "Perfect_files", "potential_description_queries": ["adenocarcinoma", "api", "appearance", "assessment", "associated", "background", "biopsy", "blood", "cancer", "category", "cause", "challenge", "channel", "check", "clear", "color", "combined", "compare", "competition", "consider", "contain", "content", "create", "csv", "current", "custom", "cut", "cytoplasm", "data", "dataset", "dependent", "depth", "detected", "detection", "dimension", "directly", "display", "distribution", "doctor", "domain", "eda", "ensemble", "evaluate", "even", "everything", "extension", "file", "find", "fit", "following", "form", "format", "found", "frequent", "generated", "grade", "grading", "graph", "green", "grouped", "grow", "growth", "hand", "help", "image", "include", "indicate", "infection", "inference", "info", "initially", "integer", "interactive", "isup_grade", "itself", "kaggle", "karolinska", "kernel", "knowledge", "lab", "label", "learning", "left", "level", "load", "look", "lost", "lower", "major", "majority", "map", "mask", "matplotlib", "men", "merge", "microphotograph", "might", "most", "multiple", "my", "need", "negative", "next", "no", "noise", "non", "normal", "not", "notebook", "nuclei", "open", "openslide", "overlay", "part", "partial", "pathologist", "perform", "picture", "place", "png", "present", "procedure", "prostate", "provider", "python", "question", "radbound", "range", "rare", "rating", "read", "recommend", "rectum", "relative", "resize", "resolution", "sample", "save", "scale", "score", "scoring", "screening", "section", "semi", "separate", "set", "several", "shape", "single", "size", "skimage", "slide", "sound", "source", "spread", "staining", "standard", "start", "step", "stroma", "structure", "supervised", "system", "target", "test", "tifffile", "tissue", "total", "train", "training", "treatment", "try", "tumor", "understanding", "unit", "up", "update", "value", "view", "visualize", "while", "who", "work", "write"], "potential_description_queries_len": 184, "potential_script_queries": ["numpy", "seaborn"], "potential_script_queries_len": 2, "potential_entities_queries": ["assessment", "cancer", "color", "grade", "image", "label", "prostate", "single", "tissue"], "potential_entities_queries_len": 9, "potential_extra_queries": ["procedure"], "potential_extra_queries_len": 1, "all_components_potential_queries_len": 185}