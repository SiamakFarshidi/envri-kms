{"name": "context aware recommender ", "full_name": " h1 A Context Aware Recommender System h1 Introduction h2 Loading Data h2 Data Validation h1 Pre Filtering h2 Finding DBSCAN Parameters h2 DBSCAN h2 Clusters Analysis h2 Location Profiling h1 Recommendation Model h2 Creating User Location Matrix h3 Creating User User Similarity Matrix h3 Creating Context Location Matrix h3 Creating Context Context Matrix h1 Final Recommendation h3 h1 Evaluation h1 Conclusion ", "stargazers_count": 0, "forks_count": 0, "description": "Popularity Ranking PR The basic idea of this method is to rank tourist locations based on the popularity of each location 3 https www. Pandas and Numpy configs Input data files are available in the. overrightarrow r_2. Huang Context Aware Location Recommendation Using Geotagged Photos in Social Media ISPRS International Journal of Geo Information vol. Creating Context Location MatrixThe matrix below shows the number of visits from venues in various contexts. It increases proportionally with the number of times a word appears in the document is offset by the frequency of the word in the corpus 2 https www. TF IDF is used in the field of information retrieval to measure how important a word is to a document in a collection or corpus. overrightarrow r_2 overrightarrow r_1. net publication 309541764_Context Aware_Location_Recommendation_Using_Geotagged_Photos_in_Social_Media 3. This dataset is assumed as LPD Location Profile Dataframe. Please leave your feedbacks and suggestions below as well. ConclusionIn this kernel we create a tourism recommendation system based on contexts and geo tagged photos. This includes the steps below 1. The visit probability of each candidate location is calculated in the current contexts such that the probability of visiting the location i equals the fraction of the users who visited the location i in contexts similar to the target user and the similarity of the current contexts with the visiting context of the neighbors is larger than a threshold like delta. However based on asymmetric similarity user u is similar to user v but not vice versa 1 http dx. Collaborative filtering using asymmetric cosine similarity and matrix factorization MF_ACOS The difference between this model and the cosine similarity approach is to eliminate the sparsity of the similarity matrix by using the matrix factorization 1 http dx. Our hybrid approach first looks for similarity among users using an asymmetric similarity metric and then uses collaborative filtering to predict the item ratings. The system is able to understand various contextual conditions such as location time of visit day night season and weather conditions of the venue at the time of visit. com science article abs pii S0169023X14000962. We use the term frequency inverse document frequency TF IDF measure to compute the usage of a location in a specific situation w_l c. com science article abs pii S0169023X14000962 If you enjoyed reading the kernel hit the upvote button. A Context Aware Recommender SystemIn this notebook we will attempt at implementing a context aware recommender system. Generate Final Recommendations5. Jung Exploiting matrix factorization to asymmetric user similarities in recommendation systems Knowledge Based Systems vol. Finding DBSCAN ParametersWe need to know the best performing parameters of DBSCAN clustering. Collaborative filtering using asymmetric cosine similarity ACOS This method uses an asymmetric cosine similarity measure to find similarities among users then by collaborative filtering ratings can be predicted 1 http dx. Center is the coordinate of the nearest point to the reference point. The output of DBSCAN is a set of photo clusters L l_1 l_2. overrightarrow r_v. Each member of this set is a tourist venue that can be considered as l_i P_ l_i g_ l_i. N_ c oslash shows the number of visits to all locations in the context c. They are classified into non contextual and context aware categories. For making recommendation model only tourists who have visited at least 4 distinct locations were selected. Building Recommendation Model4. So through a trial and error approach we determine the appropriate values for eps and min_pts min_samples. Recommendation Model The POI dataset including contextual factors is imported. The proposed approach uses a hybrid collaborative filtering method in order to recommend locations in a city for users based on their history of visits and users contexts. Creating Context Context Matrix Final Recommendation Based on the tourist location profiles and user similarities the locations which have not been rated by the user could be predicted by applying user based collaborative filtering. Init ploty in offline mode Change data types Read file into a variable data Show head Find total missing values Remove missing values Create dataframe filled with DBSCAN params and clusters DBSCAN based on Haversine metric DBSCAN trend epsilons and clusters DBSCAN trend samples and clusters Calculate DBSCAN based on Haversine metric Find most centered sample in a cluster Put clusters and their subset of coords in an array Find centroid of each cluster Pull rows from original data frame where row numbers match the clustered data Append cluster numbers and centroid coords to each clustered dataframe Convet matplotlib colormap to plotly Show plot Check if label number is 0 then create noisy points Check the remaining clusters Bokeh plot Map plot Remove noise cluster from the training set Distribution plot Find most frequent string in array Find median of array included Timestamps Create database of locations Create a lint to download Path of file to read Change data types Read csv file and convert it to a Multiindex Split dataset Find ratings Normalize number of visit into a range of 1 to 5 Create a rating matrix Calculate the sparcity percentage of matrix Create user user similarity matrix Cosine similarity matrix distance Asymmetric coefficient Sorensen similarity matrix distance User influence coefficient Check if matrix factorization was True Binary similarity matrix Find probability of contexts Create a context location matrix Means of all users Check if l is in r_rating Find similar users rated the location that target user hasn t visited Check if there is any similar user to target user Collaborative filtering with post filtered contexts Calculate cf Get contexts of similar users visited the location Find similarity of the current context to location contexts Filter users whose similarity bigger than delta Location popularity based on current context Find ratings Proposed approach Recommendation Check if model is context aware Top 10 recommendations Check if model is context aware Delta influence on the prediction and racall Asymmetric cosine similarity Cosine similarity matrix distance Asymmetric coefficient Sorensen similarity matrix distance Final similarity matrix Check if matrix factorization was True Calculate user similarities Methods Similarity measure based on location popularity Calculate location pop Create location popularity matrix Calculate user similarities Calculate user similarities Methods Find users who visit the location in the current context Calculate visit probability in exact match context Calculate visit probability of location Calculate visit probability in current context. Five different models have been selected from previous studies to compare with the proposed model. For example a venue has been visited 3 times in the context 1 1 9 which means this context is equal to season spring daytime partly cloudy day weather day To make it easier to work with the data the value of each context has turned into numbers Weather 1 clear day 2 clear night 3 rain 4 snow 5 sleet 6 wind 7 fog 8 cloudy 9 partly cloudy day 10 partly cloudy night Season 1 spring 2 summer 3 autumn 4 winter Daytime 1 day 2 night 3 midnight We use a method based on TF IDF to find the visit probability of locations 2 https www. P_ l_i is the set of all photos taken in location l_i in which the geographical coordinate of the centroid is g_ l_i. In the next step the user similarity should be calculated. net publication 309541764_Context Aware_Location_Recommendation_Using_Geotagged_Photos_in_Social_Media. Clustering data with DBSCAN and find potential points in each cluster. Evaluation Introduction This soultion includes two major steps pre filtering geo tagged data in order to detect tourists venues and building a recommendation model considering users asymmetric similarities and visit probablity in the user s current context. Context aware collaborative filtering using Sorensen Dice coef ficient Sorensen CaCF Post This method uses the Sorensen Dice coefficient to find similarity among users. begin equation w_l c TF_l times IDF_l frac N_ c l N_ c oslash times log frac N_ oslash oslash N_ oslash l end equation N_ c l is the number of visits in context c that visited location l. Location ProfilingAt this step we are looking for features related to each tourist location extracted from the previous step. Context aware significant tourist locations recommendations CSR The basis of this model is to predict the ranking of the tourist location based on the context of the target user. Data then is split into training data and test data. Profiling locations This step identifies tourist locations their time of visits as well as visited pattern of each location in terms of different contextual factors. The proposed method ultimately uses a context aware post filtering approach to determine the final recommendations. frac 2 u cap v u v end equation In case of having same numbers of items venues rated by both users the ACOS u_1 u_2 will be equal to ACOS u_2 u_1. It is important to know that a user may take more than one photo of the place while visiting a venue. Next the outcome dataframe POI is exported in order to extract contextual features based on photos taken times then it will be imported again. overrightarrow r_v overrightarrow r_u. Determining eps and min_sample parameters of DBSCAN clustering. So to address this problem a weighted user s influence coefficient is suggested. N_ oslash oslash is the total number of visits to all locations and N_ oslash l represents the total number of visits to the location l. frac 2 u cap v u v. 006 is as follow begin equation ACOS u v frac overrightarrow r_1. Pre filtering Locations3. Loading DataLet s load data into the raw dataframe. Top 10 locations with the highest ratings would be a list of recommendations. According to the asymmetric similarity concept Most of the traditional similarity metrics assign equal value for the similarity relation between two users This means these methods are based on the assumption that sim u v sim v u. If not the median of timestamps can be considered as the time of the visit with new contexts. Evaluation In the final step we evaluate the proposed method based on common evaluation metrics in recommendation systems MAP and RMSE. Clusters AnalysisThe plots below illustrate all clusters and their centroids in two geographical and non geographical views. After calculating the visiting probability the final rating associated with each candidate location is obtained by begin equation score u_a i collaborative filtering rate times visit probability end equation As an example let s see the result of rating prediction related to a user visited different locations in London city. Creating User Location MatrixTo create rating matrix we need to know the number of times when each user has visited different venues. We use the user based collaborative filtering to predict the initial ratings. Data ValidationIn this step we find and remove rows including coordinates latitude and longitude with NA Null value. frac sum_ i 1 n r_ u i prime times r_ v i prime sum_ i 1 n r_ v i prime end equation Creating User User Similarity MatrixNow let s create the user user similarity matrix. The user s similarity based on an asymmetric cosine similarity proposed by Pirasteh et al 1 http dx. This method uses the likelihood of visiting the destination exactly in the context of the target user to filter out the tourist destinations 3 https www. DBSCANWe choose eps 120 and min_sample 10 to the data. Therefore if the duration between the time stamps of two photos taken by a user at the same location is less than visit duration threshold threshold we can cosider that both photos belong to a same location. begin equation bar r_ u frac sum_ j 1 n r_ i j n_i end equation begin equation r_ u prime begin cases 1 qquad if quad r_u geq bar r_ u 0 qquad otherwise end cases end equation begin equation W_ u v prime frac sum_ i 1 n r_ u i prime times r_ v i prime sum_ i 1 n r_ v i prime end equation We propose an extended version of ACOS u v begin equation ACOS u v frac overrightarrow r_u. Pre Filtering Using DBSCAN clustering we try to remove noise coordinates and find potential locations can be considered as tourist venues. Chen A system for mining in teresting tourist locations and travel sequences from public geo tagged photos Data Knowledge Engineering vol. Ratings is also normilized by the min max normalization method. Traditional methods cannot differentiate between these two users. We also compare the performance of proposed model against some other recommendation methods. A post filtering approach is used to adjust predicted ratings according to contextual information. The dataset contains photo records including meta tags related to photos and users who took them. frac u cap v u. It also uses a probability ratio to find the visit probability of locations similar to the target user s context which is applied to the collaborative filtering results as a post filtering 2 https www. Finding the center of each cluster Because of the arbitrary shape of the clusters in DBSCAN method we find the reference point of each cluster by assuming the summation of latitudes and longitudes divided by numbers of points inside of each cluster. Each location identified in the clustering contains information such as the geographical location id of the user who visited the venue visiting time and visiting contexts. ", "id": "amiralisa/context-aware-recommender", "size": "13126", "language": "python", "html_url": "https://www.kaggle.com/code/amiralisa/context-aware-recommender", "git_url": "https://www.kaggle.com/code/amiralisa/context-aware-recommender", "script": "sklearn.metrics randint asymCo item_relevancy asymmetric_cosine mapk mostFreqStr matplotlibToPlotly sklearn.cluster mean_average_precision predict random loc_pop_sim great_circle NMF MultiPoint ACOS predict_all sklearn.metrics.pairwise MultiLabelBinarizer mean_squared_error improved_asym_cosine numpy pairwise_distances PR plotly.graph_objs CaCF_Post minmax_scale sklearn.decomposition calSparcity usrInfCo DBSCAN sklearn.model_selection chunk matplotlib.pyplot cosine_similarity pandas apk medTimestamps getCenterMostPts MF_ACOS rmse download_csv_file shapely.geometry paramsClusters normalize CSR create_download_link EACOS_CaCF_Post CF sklearn.preprocessing ml_metrics HDBSCAN geopy.distance train_test_split Sorensen_CaCF_Post ", "entities": "(('Chen A system', 'photos Data Knowledge Engineering vol'), 'tag') (('user', 'venue'), 'be') (('photos', 'same location'), 'be') (('dataset', 'LPD Location Profile Dataframe'), 'assume') (('we', 'inside cluster'), 'find') (('006', 'equation ACOS u v frac overrightarrow follow r_1'), 'be') (('Top', 'recommendations'), 'be') (('proposed method', 'final recommendations'), 'use') (('post filtering approach', 'contextual information'), 'use') (('Context Aware Recommender notebook we', 'recommender context aware system'), 'SystemIn') (('Center', 'reference point'), 'be') (('we', 'eps'), 'determine') (('similarity', 'et 1 dx'), 'http') (('We', 'initial ratings'), 'use') (('DBSCAN ParametersWe', 'DBSCAN clustering'), 'need') (('configs Input data Pandas files', 'the'), 'be') (('basis', 'target user'), 'recommendation') (('L', 'l_1 l_2'), 'be') (('DBSCANWe', '120 10 data'), 'choose') (('step', 'different contextual factors'), 'identify') (('then it', 'times'), 'import') (('kernel we', 'contexts'), 'conclusionin') (('who', 'at least 4 distinct locations'), 'select') (('method', 'tourist destinations'), 'use') (('difference', 'http 1 dx'), 'MF_ACOS') (('7 8 9 partly cloudy 10 partly cloudy Season 1 spring 2 summer 3 autumn 4 1 2 night 3 midnight We', 'locations'), 'visit') (('influence weighted coefficient', 'So problem'), 'suggest') (('MatrixThe matrix', 'various contexts'), 'create') (('hybrid approach', 'item ratings'), 'look') (('tourist that', 'P _ l_i g l_i _'), 'be') (('l', 'location l.'), 'be') (('median', 'new contexts'), 'consider') (('geographical coordinate', 'centroid'), 'be') (('we', 'recommendation systems MAP'), 'evaluation') (('method', 'users'), 'filtering') (('which', 'post https filtering 2 www'), 'use') (('how word', 'collection'), 'use') (('Popularity Ranking basic idea', 'location'), 'pr') (('Location step we', 'previous step'), 'ProfilingAt') (('who', 'current context'), 'read') (('They', 'non contextual aware categories'), 'classify') (('Ratings', 'min max normalization also method'), 'normilize') (('user similarity', 'next step'), 'calculate') (('Five different models', 'proposed model'), 'select') (('that', 'location l.'), 'begin') (('s', 'user user similarity matrix'), 'i') (('s', 'London city'), 'obtain') (('We', 'recommendation other methods'), 'compare') (('who', 'them'), 'contain') (('TF IDF', 'specific situation'), 'use') (('who', 'delta'), 'calculate') (('Recommendation POI dataset', 'contextual factors'), 'Model') (('when user', 'different venues'), 'create') (('Data step we', 'NA Null value'), 'ValidationIn') (('Clusters AnalysisThe plots', 'two geographical views'), 'illustrate') (('com science article abs pii you', 'upvote button'), 'S0169023X14000962') (('word', 'https corpus 2 www'), 'increase') (('method', 'then collaborative filtering ratings'), 'filtering') (('u_1 u_2', 'ACOS u_2 u_1'), 'frac') (('that', 'v sim u.'), 'assign') (('N _ c oslash', 'context c.'), 'show') (('two major steps filtering geo', 'current context'), 'introduction') (('Data', 'training then data'), 'split') (('end prime We', 'ACOS'), 'begin') (('Traditional methods', 'two users'), 'differentiate') (('which', 'based collaborative filtering'), 'similarity') (('who', 'contexts'), 'contain') (('potential locations', 'tourist venues'), 'cluster') (('system', 'visit'), 'be') (('proposed approach', 'visits'), 'use') ", "extra": "['outcome', 'test']", "label": "Perfect_files", "potential_description_queries": ["adjust", "approach", "array", "article", "assign", "associated", "basic", "best", "case", "center", "centroid", "choose", "city", "clear", "cluster", "clustering", "coef", "coefficient", "collection", "compare", "compute", "concept", "context", "convert", "cosine", "could", "create", "csv", "current", "data", "database", "dataframe", "dataset", "day", "detect", "difference", "distance", "document", "download", "duration", "end", "equal", "equation", "error", "evaluate", "evaluation", "extract", "field", "file", "filter", "filtered", "final", "find", "frac", "frame", "frequency", "frequent", "head", "history", "http", "id", "idea", "including", "influence", "item", "kernel", "label", "least", "leave", "let", "likelihood", "list", "load", "log", "looking", "major", "match", "matplotlib", "matrix", "max", "measure", "median", "meta", "method", "metric", "min", "missing", "mode", "model", "most", "nearest", "need", "new", "next", "noise", "non", "normalization", "not", "notebook", "number", "offline", "offset", "order", "out", "outcome", "output", "pattern", "percentage", "performance", "performing", "photo", "place", "plot", "plotly", "point", "post", "potential", "pre", "predict", "prediction", "probability", "problem", "public", "publication", "range", "rank", "ranking", "rating", "ratio", "raw", "read", "reading", "recommend", "recommendation", "recommender", "reference", "relation", "remove", "result", "row", "sample", "science", "score", "selected", "set", "shape", "sim", "similar", "similarity", "situation", "split", "step", "string", "subset", "system", "target", "term", "test", "threshold", "through", "time", "total", "training", "trend", "trial", "try", "usage", "user", "value", "variable", "version", "visit", "while", "who", "word", "work"], "potential_description_queries_len": 176, "potential_script_queries": ["chunk", "normalize", "numpy", "randint", "random", "rmse", "sklearn"], "potential_script_queries_len": 7, "potential_entities_queries": ["basic", "data", "least", "max", "notebook", "sim", "step"], "potential_entities_queries_len": 7, "potential_extra_queries": [], "potential_extra_queries_len": 0, "all_components_potential_queries_len": 182}