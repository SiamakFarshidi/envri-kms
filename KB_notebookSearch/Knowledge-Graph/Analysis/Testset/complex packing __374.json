{"name": "complex packing ", "full_name": " h3 general jupyter and cv2 utility helpers h3 cv2 contour bounding rect extraction h3 write bounding rects to a cache h3 rectangle cropping and scaling helpers h3 rectangle and image packing helpers h3 get image packer for defining packers ", "stargazers_count": 0, "forks_count": 0, "description": "level_2_packed pack_run. append sample return metrics failures metrics failures consider_packer whats_up_with failures metrics failures consider_packer get_image_packer 128 8 128 8 retry_halved 4 retry_eager_splits 6 4 len metrics get_image_packer 128 8 128 8 retry_halved 4 retry_eager_splits 6 4 chunks_of failures 0 whats_up_with failures show_image_row get_image_packer 128 10 128 10 retry_halved 8 retry_eager_splits 6 4 chunks_of s s 0 for s in a10eb69fb260132fde150bd76bd7b15c 1836f6539ccc9e37d426603cc4526f8b 1f368e9829e850bd6b6de7a521376720 000920ad0b612851f8e01bcc880d9b3d 031f5ef5b254fbacd6fbd279ebfe5cc0 004391d48d58b18156f811087cd38abf metrics consider_packer show_slides s show_image_row chunks_of s i pack_images chunks_of s 2 0 i show_image_row pack_images chunks_of s 2 0 for s in 1836f6539ccc9e37d426603cc4526f8b 1f368e9829e850bd6b6de7a521376720 000920ad0b612851f8e01bcc880d9b3d 031f5ef5b254fbacd6fbd279ebfe5cc0 004391d48d58b18156f811087cd38abf show_slides s show_image_row chunks_of s show_image_row print np. items 0 samples 000920ad0b612851f8e01bcc880d9b3d 031f5ef5b254fbacd6fbd279ebfe5cc0 004391d48d58b18156f811087cd38abf get_image_packer 128 10 128 8 chunks_of 031f5ef5b254fbacd6fbd279ebfe5cc0 031f5ef5b254fbacd6fbd279ebfe5cc0 0 s pack_images chunks_of i 1 for i in df. now show_image_row _flatten pack_images chunks_of i 0 pack_hi chunks_of i 1 0 for i in df. index figsize 50 20 p get_image_packer 128 8 128 8 retry_halved 4 retry_eager_splits 6 4 bigboys pack_images chunks_of i for i in failures print b 1 for b in bigboys show_image_row b 0 for b in bigboys figsize 50 20 show_image_row chunks_of 000920ad0b612851f8e01bcc880d9b3d pack_images get_image_packer 128 8 128 8 retry_halved 4 recontour_at 1. general jupyter and cv2 utility helpers cv2 contour bounding rect extraction write bounding rects to a cache rectangle cropping and scaling helpers rectangle and image packing helpers get_image_packer for defining packersbusiness are connecting 1 to another a37b456a2bc920630c60c2ff0c7d6325 I could have gotten them smaller if I had just munged outliers level 0 is shape 13312 15360 level 1 is shape 3328 3840 4 level 2 is shape 832 960 16 center float float size float float theta float am fairly salty about this https www. json recontouring_pack_run. com product feedback 99742 show_image_row chunks_of 000920ad0b612851f8e01bcc880d9b3d 0 645x137 wsi pil_tiff_frame str TRAIN 000920ad0b612851f8e01bcc880d9b3d. index show_image_row pack_images chunks_of i 1 0 for i in df. index loosen retry_halved for our special case mv. 3728 gigabytes tarred will be 3. 0 pack_hi get_image_packer 4 128 8 4 128 8 retry_halved 4 datetime. now pack_hi get_image_packer 16 128 8 16 128 8 retry_halved 4 recontour_at 1 16 s pack_hi chunks_of i 0 for i in df. now h m pack_hi chunks_of a10eb69fb260132fde150bd76bd7b15c 1 cv2. rotate 90 expand True i metrics pack_images chunks_of 1836f6539ccc9e37d426603cc4526f8b 2 i 0 s 1f368e9829e850bd6b6de7a521376720 def whats_up_with image_ids for image_id in image_ids show_slides image_id show_image_row chunks_of image_id def consider_packer pack pack_images n None metrics global s failures for index sample in enumerate df. now h Image. index chunks chunks_of i level 2 p metrics pack_images chunks i packed. BILINEAR print datetime. now print datetime. index d datetime. index try metrics. resize print datetime. __version__ print datetime. MAX_IMAGE_PIXELS 268435456 1 metrics pack_images chunks_of sample 2 sample 1 for sample in df. array c or c for c in chunks_of s for sample in samples df. append pack chunks_of sample 2 sample 1 except Exception as e print f sample failed s sample failures. resize int 15360 16 int 13312 16 resample Image. append p print metrics show_image_row packed chunks packed image_id info list chunk_window_cache. index try show_image_row pack_images chunks_of sample 2 0 figsize 50 20 except Exception as e print sample raise e result metrics get_image_packer 128 6 128 6 retry_halved 4 retry_eager_splits 12 chunks_of 1836f6539ccc9e37d426603cc4526f8b result whats_up_with 1836f6539ccc9e37d426603cc4526f8b slender denny and lenny big bertha 10000 128 20 128 6 3 8 bytes to gigabytes is 7. now Get center size and angle from rect convert to rad chunk_source_shape is height width rgb generic rect packer if tuple contains two elements assume they are width and height and origin is 0 0 empty PackNode PIL crop boxes areas are left upper right lower PIL crop boxes areas are left upper right lower PIL crop boxes areas are left upper right lower Crop empty space Remove by row Remove by column crop box is left upper right lower crop box is left upper right lower skip all white chunks abstracted out halve_image into split_strategy so we can retry with recontouring todo this exception handling error checking is bad ugly pack_images get_image_packer 128 20 128 6 retry_halved 4 get_image_packer 128 8 128 8 retry_halved 4 pack_images_hi get_image_packer 4 128 30 4 128 10 s a10eb69fb260132fde150bd76bd7b15c a6a7146bd23b394f54a5950d2dbefa7b 1836f6539ccc9e37d426603cc4526f8b pack_images get_image_packer 128 20 128 6 retry_halved 4 packed for i in range 0 3 for i in df. This is ok for now but won t be for level 1 output_dimensions 128 20 128 6 128 13 128 5 saved under run_1664x640 128 12 128 4 under run_1536x512 whats_up_with 01571191abf6e8e209111e819823759b or df. index print datetime. index i show_image_row chunks_of 00928370e2dfeb8a507667ef1d4efcbb 0 i. ", "id": "micimize/complex-packing", "size": "374", "language": "python", "html_url": "https://www.kaggle.com/code/micimize/complex-packing", "git_url": "https://www.kaggle.com/code/micimize/complex-packing", "script": "width get_chunk_loader _can_contain crop_tilted_rect cropped_contours_of try_inplace_center pyplot halve_and_recontour reject_outlying_deltas typing consider_packer chunks_of Image where_not_none to_timedelta skimage.io pyplot as plt reject_outliers read_json cv2_threshold write_chunk_windows numpy _reduce_bounding_boxes PackNode(object) height write_packed_images pandas cv2_tiff_frame insert show_slides write_json pil_tiff_frame imshow cut_empty_space matplotlib cv2_to_pil pil_image matplotlib.image _tilted_rect_area meaningful_pixels figure eager_splits pack_images imread __repr__ sum_values PIL _max_bounds recontour_parts axis area_to_right_of scale_factor _pack contours_of area_below area_from_upper_left interleave pil_to_cv2 datetime cv2_image __init__ filled_bounding_box _longest_side_ascending halve_image Path whats_up_with count_where Timedelta tissue_chunk_windows_of scaled_chunks_of pathlib show_image_row summarize_metrics matplotlib.pyplot center_bounds scaled_rect MultiImage get_image_packer ", "entities": "(('a10eb69fb260132fde150bd76bd7b15c 128 4 10 1836f6539ccc9e37d426603cc4526f8b pack_images', 'df'), 'be') (('center float float size float float theta 1 3328 3840 4 level 2 832 960 16 float', 'https fairly www'), 'write') (('def consider_packer pack_images None', 'enumerate df'), 'rotate') (('i', '0 i.'), 'show_image_row') (('pack_images', '128 8 128 8'), 'figsize') (('slender 3 128 6 128 6 4 retry_eager_splits 12 1836f6539ccc9e37d426603cc4526f8b whats_up_with 1836f6539ccc9e37d426603cc4526f8b denny big 10000 128 20 128 6 8 bytes', 'gigabytes'), 'try') (('items 0 004391d48d58b18156f811087cd38abf', 'df'), 'sample') (('index show_image_row', 'df'), 'pack_images') (('i', 'chunks'), 'chunk') (('2 0 i', '1836f6539ccc9e37d426603cc4526f8b 1f368e9829e850bd6b6de7a521376720'), 'failure') (('packed chunks', 'info list chunk_window_cache'), 'show_image_row') (('This', 'whats_up_with 128 12 128 4 01571191abf6e8e209111e819823759b'), 'be') (('268435456 1 metrics', 'df'), 'pack_image') ", "extra": "['cd3']", "label": "Perfect_files", "potential_description_queries": ["append", "array", "bounding", "box", "cache", "case", "center", "checking", "column", "contour", "convert", "could", "crop", "cv2", "def", "empty", "enumerate", "error", "expand", "extraction", "feedback", "float", "general", "generic", "height", "image", "index", "info", "int", "json", "left", "len", "level", "list", "lower", "out", "pack", "print", "product", "range", "resample", "resize", "result", "return", "rgb", "right", "rotate", "row", "sample", "scaling", "shape", "size", "space", "special", "str", "try", "tuple", "under", "upper", "width", "write", "wsi"], "potential_description_queries_len": 62, "potential_script_queries": ["datetime", "figure", "imread", "imshow", "insert", "interleave", "matplotlib", "numpy", "pathlib", "plt", "pyplot"], "potential_script_queries_len": 11, "potential_entities_queries": ["level", "size"], "potential_entities_queries_len": 2, "potential_extra_queries": ["cd3"], "potential_extra_queries_len": 1, "all_components_potential_queries_len": 73}