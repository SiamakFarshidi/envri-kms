{"name": "drugs moa classification eda ", "full_name": " h1 Mechanisms of Action MoA Prediction EDA h3 BLOG POST DRUG DISCOVERY WITH NEURAL NETWORKS h3 PROJECT CONTENT ", "stargazers_count": 0, "forks_count": 0, "description": "png Image source Blog PostIn this competition we are suposed to develop algorithms and train models to determine the mechanism of action of a new drug based on the gene expression and cell viability information. Very few control samples. 4 1 4 Targets with the highest MoA correlation 2 Target pairs have 0. Let s have a closer look over these targets. The functionality of these targets and their distribution is something to be taken into consideration because in this case we have a multi label classification problem where the correlation between the labels is also important and the model selection should be based on the labels correlation. Now that we know that 71 targets don t have any mechanism of action let s compare the targets with MoA in the nonscore dataset with the score one. I will update this section in the future with deeper analysis. Good news It seems that both train and test datasets are similar in terms of experimental conditions. 9 correlation Those target pairs must be in the few samples that have more than two active targets. cp_vehicle or with a control perturbation ctrl_vehicle control perturbations have no MoAs. 1 Scored targets 4. Few control samples. 4 2 3 Heatmap of the 31 target with high correlation Interesting Even though this is just a visual representation of the table above here we can clearly see that many targets from the scored_target dataset have high correlation with several targets from the nonscored_targets. The second most frequent drugs is 87d714366 with 718 rows 4 3 2 Examples In section 4. 4 1 2 Targets Drug types Inhibitor targets are dominating with 121 targets out of 206. Observations 1. Here we see that the extra nonscored dataset contains 71 targets without ANY mechanism or action MoA. Kit_inhibtor is highly correlated with 2 targets pdgfr_inhibitor and flt3_inhibitor. 2 Cell viability Let s see the difference between the cell viability in a control and treated sample. We can deduct from the latest findings that the nonscored targets have less MoA in comparison to the scored ones. Let s have a closer look at the high correlation genes. Viability can be distinguished from the all or nothing states of life and death by the use of a quantifiable index that ranges between the integers of 0 and 1 or if more easily understood the range of 0 and 100. 5 new gene pairs seem to be highly correlated in the test set then in the train set. This dataset can be used for transfer learning We have seen in the previous section that the scored targets had 0 1 in all the samples in other words ALL THE TARGETS HAD A MoA IN AT LEAST ONE SAMPLE. The low and high doses were applied equally. In other words High negative values High number of dead cells High positive values High number of living cells. This is just a first impression after checking multiple cell lines We need to check all the cell lines to draw conclusions. The variation would be in the gene expression and cell viability since the samples used in the test set are different than the train set. 2 Non Scored targets 4. 1 Categorical features First glimpse 876 features with Features g signify gene expression data. However more investigation is needed to find some patterns and differences in gene expression between the train and test sets. To understand this better let s first merge both scored and nonscored targets datasets and try to find patterns and relationships between the targets in both datasets. If in the scored_target dataset we had just 4 target pairs with 0. We will come back to this later We can see many target labels in the plot inhibitor agonist antagonist. However this doesn t mean that the information in the nonscored dataset can t be useful because if the nonscored targets have just 1 MoA and it happens that this 1 single MoA coincides with the scored targets in the same samples then we might have interesting correlation between both targets. These products are often proteins. For more info you can check this discussion topic Extracting insights from Drug_ID https www. The presence of the targets is very low in the samples Mostly less than 0. Those are the outlier drugs the drugs that were profiled more than 18 times Next let s check the other drugs normally 1 drug was profiled 6 times 2 doses x 3 treatment times if a drug was profiled twice it will have 12 samples per drug_id. Strong negative correlation genes We have 34 gene pairs with 0. This is just a quick look over the TOP10 genes. 7 correlation by merging both datasets we have more than 15 target pairs highly correlated. nfkb_inhibitor and proteasome_inhibitor have 0. 4 1 1 Most frequent targets It seems we have 2 outliers here nfkb_inhibitor and proteasome_inhibitor. Viability assays provide a more precise basis for measurement of an organism s level of vitality. PROJECT CONTENT 1 FEATURES OVERVIEW 2 CELL VIABILITY FEATURES 3. 3 Treatment time Next let s see the impact of the treatment time on the cell viability. Interesting The control samples were not included so the negative correlation between some genes is not related to the control treated samples. Other factors are related to the drug types and the genes the information about drugs genes and cells is not provided 4 Targets MoA 4 1 Scored targets This is a multi label classification we have 207 MoA and we have to find out the mechanism of action of the 5000 drugs that were treated in the sig_id samples. 5 Mean gene expression of g xxx featuresThe mean gene expression of the 772 genes show some strong negative and positive gene expression values. This information will be useful we will come back to it in the following sections. Only 64 drugs have 12 samples I was expecting more drugs to be profiled twice. 5 Test features After understanding the relationship between the features and the labels we move on to the test set to understand the features and their relationship with the train features. com max 700 1 AYJLRDxyO6MWGVSaP6Fm2w. This dataset has 402 MoAs more than the 206 MoAs in the targets_scored dataset that will be used in the score. Viability can be observed through the physical properties of cells tissues and organs. read_csv Datasets for treated and control experiments Datasets for treated and control TEST SET Treatment time datasets Merge scored and nonscored labels Treated drugs without control Select the columns c Filter the TEST set Treated drugs adt All Drugs Treated Select the columns c Filter the columns c Select the columns g Filter the columns g 1 rows 2 cols first row first col first row sec col 1 rows 2 cols first row first col first row sec col first row 3rd column 2 rows 2 cols first row first col first row sec col Second row first column second row second column corrs function Show dataframe of high correlation between features Correlation between genes Unstack the dataframe Create new dataframe Filter out the coef 1 correlation between the same drugs Drop pair duplicates Show the first 10 high correlations changes apply to the x axis both major and minor ticks are affected ticks along the bottom edge are off ticks along the top edge are off labels along the bottom edge are off Filter out just the treated samples Count unique values per column specify the columns whose unique values you want here Calculate the mean values Filter just the drugs with mean 0. 4 2 2 Non scored targets correlation Great This nonscored dataset seems promising. Agonists receptors and antagonists come at the second plan. 1 g xxx features 3. Same treatment duration 24h 48h and 72h. It is worth recalling that the presence of active targets in the samples in very low mainly 1 or 2 targets per sample. Some targets outliers have a higher presence in comparison with the rest of targets with a percentage in the range 3 4. 3 Treatment time let s check the impact of the treatment time on the gene expression. The order of the cells correlation is different in the test set References 1 Viability assay https en. A high negative cell viability measure reflects a high fraction of killing by the host https www. 4 2 Nonscored targets In this section we will have a look over the dataset provided that will not be used in the score. org wiki Viability_assay 2 COVID 19 viral proteins identification https www. com amiiiney covid 19 proteins identification with biopython to understand more how gene expression works. 3 To understand this better let s compare the samples treated with the drugs and the control samples. 8 correlation in comparison with the 4187 in the train set. Only 3 drugs have 18 sample the drugs were profiled 3 times. 5 1 Features Everything seems similar to the train set The doses are equally applied. 2 Gene expression How to interpret those values Gene expression levels are calculated by the ratio between the expression of the target gene i. 196 drugs were profiled 7 times so 1 additional sample with respect to most of the drugs perhaps a dosage or treatment time experiment was repeated for those drugs My Drug_id conclusion I am not sure why the competition host chose some drugs to be profiled hundreds of times but the data shows that most of the drugs exactly 2774 drug were profiled just once 6 samples my intuition is that those samples will not be present in the test however the drugs with 18 samples were intentionally profiled 100s of times because they have some mechanism of action targets that the test set drugs have. 3 10 cell pairs in the test set are not present in the train set. com c lish moa discussion 195217. The samples having 2 active targets most probably include those 4 target pairs. 9 correlation and are highly presented in the samples. Another drug d50f18348 was profiled 178 times and has 3 MoAs The other most frequent drugs have cdk_inhibitor egfr_inhibitor and tubulin_inhibitor as MoAs. eu cancer forx therapeutics cancer treatment linear algebra data processing CSV file I O e. A single sample treated with a drug can have many active targets in other words one drug can have more than 1 mechanism of action so we have to predict the mechanisms of action of each drug. cp_time and cp_dose indicate treatment duration 24 48 72 hours and dose high or low. cp_type indicates samples treated with a compound trt_cp samples treated with the compounds. Findings based on the top 10 cell pairs 4377 cell pairs have 0. 01 1 rows 2 cols first row first col first row sec col Select the columns c Filter the columns c Plot heatmap Select the columns g Filter the columns g Plot heatmap Correlation between drugs Unstack the dataframe Create new dataframe Filter out the coef 1 correlation between the same drugs Drop pair duplicates Show the first 10 high correlations Transpose the dataframe Calculate the mean of each g_xxx feature Plot the mean values 1 rows 2 cols first row first col first row sec col Correlation between drugs Unstack the dataframe Create new dataframe Filter out the coef 1 correlation between the same drugs Drop pair duplicates Show the first 10 high correlations Extract unique elements per column specify the columns whose unique values you want here 1 rows 2 cols first row first col first row sec col Filter out just the treated samples Calculate the mean values Filter just the drugs with mean 0. However we notice some yellow dots high correlation between some targets. Mechanisms of Action MoA Prediction EDA BLOG POST DRUG DISCOVERY WITH NEURAL NETWORKS https medium. Here we have values in the range 10 and 6 because the data were z scored and then normalized using a procedure called quantile normalization https clue. 4 Cells correlation Let s see the correlation between cell viability features in the treated samples no control. Features c signify cell viability data. In this EDA we will try to find patterns in the data interactions between the targets in both scored and nonscored datasets and the relationship between targets and their target genes. 1 figure 2 we have seen that we had 2 outliers proteasome_inhibitor and nfkb_inhibitor I first thought that that there were many drugs with those MoAs in the train set but apparently most of them belong to one single drug 87d714366 that was profiled 718 times. com amiiiney covid 19 proteins identification with biopython 3 Gene expression level https www. Let s see how different are those samples 5 2 Gene expression We can see several high positive and negative correlations between some genes same as in the train set. Top 10 gene pairs in the test set Observations 5 10 high correlated genes are the same as in the train set see section 3. 3 treatment durations 24h 48h and 72h. 5 3 Cell viability Now we check the high correlation cells and comapre them to the train test. Observations As expected 2774 drugs out of 3700 drugs have 6 rows that correspond to 2 doses and 3 treatment times. Understanding the difference between the genes correlation in the train and test sets will be crucial to determine and prevent the shake up. com topics biochemistry genetics and molecular biology gene expression level 4 Image credit https www. com c lish moa discussion 191487. in the treated samples no control We have both negative and positive correlations here between genes. 4 Genes correlation let s see the correlation between gene expression features. GENE EXPRESSION FEATURES 4. Many high correlations between c features. 01 Plot the percentage of MoAs 1 rows 2 cols first row first col first row sec col Correlation between drugs Unstack the dataframe Create new dataframe Filter out the coef 1 correlation between the same drugs Drop pair duplicates Show the first 10 high correlations High correlation adt 22 pairs Filter the drug names Join the 2 lists Keep unique elements and drop duplicates Filter out the selected drugs from the all drugs treated adt dataset 1 rows 2 cols first row first col first row sec col Filter out just the treated samples Select the columns c Filter the columns c 1 rows 2 cols first row first col first row sec col Correlation between drugs Unstack the dataframe Create new dataframe Filter out the coef 1 correlation between the same drugs Drop pair duplicates Select the columns c Filter the columns c 1 rows 2 cols first row first col first row sec col. We will filter the train_targets_scored dataset and keep just the treated rows we discard the control rows because they are not treated with the drugs. 3 g Features are related to gene expression. This can be due to many factors Some drugs upregulate and others downregulate some genes For example drug A could reduce gene X expression level while drug B could elevate gene Y expression level. the gene of interest and the expression of one or more reference genes often household genes. Select a model that finds patterns not just in the train data but also in the multi label target data. 2 c Features are related to cell viability. TARGETS MoA 4. What is cell viability A viability assay is an assay that is created to determine the ability of organs cells or tissues to maintain or recover a state of survival. This is something to be taken into consideration in feature engineering. Some of these include mechanical activity motility such as with spermatozoa and granulocytes the contraction of muscle tissue or cells mitotic activity in cellular functions and more. io connectopedia glossary Q. You can refer to my notebook COVID_19 Viral proteins identification https www. Some genes have high negative correlation so gene X has a high positive gene expression value which means gene Y will have a high negative gene expression value. All the targets are present in at least one sample. 4 1 3 Correlation between targets Most of the targets have 0 correlation. 1 c xxx features First observation in this EDA As mentioned in the definition cell viability should range between the integers 0 and 1. In short the mechanism of action of the 207 targets in this study will activate some genes gene expression will take place and byproducts proteins will be synthesized. com swlh drug discovery with neural networks a6a68c76bb53 sk dc332f724905461ac5a9b5060c62141d image1 https miro. TEST FEATURES 1 Overview Features 1. 4 2 1 Percentage of non scored MoA in the samples The presence of the nonscored targets in the samples is 10 times lower than the scored ones which will be translated basically to 1 MoA per target in the samples. 3 Drug IDs UPDATE We are now provided the drug_id just for the train set it will be valuable for a more stable CV LB however I don t think it will be valuable for feature engineering since we don t have the drug_id for the test set let s dig into this new feature 4 3 1 Most frequent drugs in the train set So Drug cacb2b860 is the control vehicle this explains it s high presence in the train set. Below we will try to connect the dots and try to match the high correlated targets with the targets with the most presence in the samples. What is gene expression Gene expression is the process by which information from a gene is used in the synthesis of a functional gene product. ", "id": "amiiiney/drugs-moa-classification-eda", "size": "15252", "language": "python", "html_url": "https://www.kaggle.com/code/amiiiney/drugs-moa-classification-eda", "git_url": "https://www.kaggle.com/code/amiiiney/drugs-moa-classification-eda", "script": "set_size plot_drugid avgdrug avgfiltered plotd seaborn numpy matplotlib.pyplot corrs plotc pandas ploth mean plotf plott plotgene unidrug ", "entities": "(('png Image source Blog competition we', 'gene cell expression information'), 'PostIn') (('2 c Features', 'cell viability'), 'relate') (('Cell 5 3 Now we', 'train test'), 'viability') (('Kit_inhibtor', 'highly 2 targets'), 'correlate') (('correlation Strong negative We', '0'), 'gene') (('cell 4377 pairs', '0'), 'have') (('model also selection', 'labels correlation'), 'be') (('s', 'control'), 'let') (('you', 'Drug_ID https www'), 'check') (('s', 'correlation high genes'), 'let') (('s', 'gene expression'), 'let') (('that', '0'), 'distinguish') (('target more than 15 pairs', 'datasets'), 'correlate') (('g 3 Features', 'gene expression'), 'related') (('Drop pair', 'c columns'), '01') (('we', 'train features'), 'feature') (('Some', 'cellular functions'), 'include') (('then we', 'targets'), 'mean') (('This', 'TOP10 just quick genes'), 'be') (('com amiiiney', 'Gene expression level https biopython 3 www'), 'covid') (('s', 'score one'), 'let') (('I', 'deeper analysis'), 'update') (('they', 'drugs'), 'filter') (('TARGETS', 'AT LEAST'), 'use') (('we', 'following sections'), 'be') (('that', 'sig_id samples'), 'relate') (('gene more how expression', 'biopython'), 'covid') (('Understanding', 'shake'), 'be') (('Target 2 pairs', '0'), 'have') (('that', 'label target also multi data'), 'select') (('we', 'drug'), 'have') (('clearly many targets', 'nonscored_targets'), 'interesting') (('that', 'score'), 'have') (('Gene 5 2 We', 'train set'), 'let') (('High number', 'living High positive High cells'), 'in') (('Gene expression levels', 'target gene i.'), 'expression') (('second most frequent drugs', '3 4 2 section'), 'be') (('other most frequent drugs', 'MoAs'), 'profile') (('control perturbation ctrl_vehicle control perturbations', 'MoAs'), 'have') (('Inhibitor targets', '206'), 'dominate') (('You', 'identification https COVID_19 Viral www'), 'refer') (('gene 5 new pairs', 'train then set'), 'seem') (('information', 'gene functional product'), 'be') (('later We', 'plot inhibitor agonist antagonist'), 'come') (('doses', 'train'), 'feature') (('nfkb_inhibitor', '0'), 'have') (('87d714366 that', 'one single drug'), 'see') (('However we', 'targets'), 'notice') (('Agonists receptors', 'second plan'), 'come') (('drug B', 'gene Y expression level'), 'be') (('gene Y', 'gene expression high negative value'), 'have') (('Below we', 'samples'), 'try') (('we', '0'), 'have') (('you', 'just mean'), 'Datasets') (('train datasets', 'experimental conditions'), 'news') (('that', 'survival'), 'be') (('first nonscored targets', 'datasets'), 'score') (('mentioned', 'integers'), 'feature') (('cell viability high negative measure', 'host https www'), 'reflect') (('This', 'feature engineering'), 'be') (('byproducts proteins', 'place'), 'activate') (('it', 'train high set'), 'UPDATE') (('10 data', 'z then procedure'), 'have') (('nonscored targets', 'scored ones'), 'deduct') (('row col here 1 rows 2 first row first col first just treated samples', 'just mean'), 'Select') (('extra nonscored dataset', 'ANY mechanism'), 'see') (('that', 'score'), 'target') (('s', 'targets'), 'let') (('a6a68c76bb53', 'image1 https dc332f724905461ac5a9b5060c62141d miro'), 'discovery') (('We', 'conclusions'), 'be') (('we', '2 outliers'), 'target') (('Viability assays', 'vitality'), 'provide') (('Viability', 'cells tissues'), 'observe') (('3 cell 10 pairs', 'train set'), 'be') (('targets', 'at least one sample'), 'be') (('targets outliers', '3 4'), 'have') (('that', '2 doses'), 'have') (('presence', 'very samples'), 'be') (('drugs', '18 sample'), 'have') (('twice it', 'drug_id'), 'be') (('test set drugs', 'that'), 'profile') (('However more investigation', 'train sets'), 'need') (('negative correlation', 'control treated samples'), 'include') (('9 correlation', 'highly samples'), 'present') (('which', 'samples'), 'score') (('We', 'here genes'), 'in') (('gene expression', 'gene expression strong negative values'), 'expression') (('s', 'gene expression features'), 'let') (('It', 'mainly 1 sample'), 'be') (('more drugs', '12 samples'), 'have') (('we', 'nonscored targets'), 'try') (('better s', 'drugs'), 'let') (('cell samples', 'train set'), 'be') (('s', 'cell viability'), 'time') (('samples', 'target most probably 4 pairs'), 'include') (('order', 'Viability assay References 1 https'), 'be') (('that', 'more than two active targets'), 'correlation') (('5 10 high correlated genes', 'train set see section'), 'top') (('Most', '0 correlation'), 'have') ", "extra": "['biopsy of the greater curvature', 'test', 'granulocyte', 'procedure']", "label": "Perfect_files", "potential_description_queries": ["active", "apply", "bottom", "cancer", "case", "cell", "check", "checking", "classification", "coef", "col", "column", "compare", "comparison", "competition", "compound", "conclusion", "consideration", "control", "correlation", "correlations", "could", "credit", "data", "dataframe", "dataset", "develop", "difference", "distribution", "draw", "drop", "duration", "edge", "engineering", "expected", "experiment", "experimental", "expression", "feature", "figure", "file", "filter", "find", "following", "frequent", "function", "functional", "future", "heatmap", "high", "include", "index", "indicate", "info", "interest", "intuition", "io", "label", "learning", "least", "let", "level", "life", "linear", "look", "lower", "major", "match", "max", "mean", "measure", "measurement", "merge", "might", "model", "most", "move", "multiple", "my", "need", "negative", "neural", "new", "no", "non", "normalization", "normalized", "not", "notebook", "number", "observation", "order", "out", "outlier", "pair", "per", "percentage", "place", "plot", "png", "positive", "predict", "present", "prevent", "problem", "procedure", "processing", "provide", "range", "ratio", "reduce", "reference", "relationship", "representation", "rest", "row", "sample", "score", "second", "section", "selected", "selection", "set", "several", "short", "similar", "single", "sk", "something", "source", "state", "table", "target", "test", "think", "those", "thought", "through", "time", "tissue", "topic", "train", "transfer", "treatment", "try", "understanding", "unique", "update", "value", "variation", "while"], "potential_description_queries_len": 151, "potential_script_queries": ["numpy", "seaborn"], "potential_script_queries_len": 2, "potential_entities_queries": ["cell", "competition", "expression", "functional", "least", "most", "new", "row", "single", "target"], "potential_entities_queries_len": 10, "potential_extra_queries": ["biopsy"], "potential_extra_queries_len": 1, "all_components_potential_queries_len": 153}