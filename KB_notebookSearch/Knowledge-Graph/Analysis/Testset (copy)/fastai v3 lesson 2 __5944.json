{"name": "fastai v3 lesson 2 ", "full_name": " h3 Note The nb displays an error since the num of files downloaded limit imposed by kaggle If you fork and run the nb cell by cell it should run normally you will have to uncomment each line of code h1 Creating your own dataset from Google Images h2 Get a list of URLs h2 View data h2 Interpretation h2 Cleaning Up h2 Putting your model in production h2 Things that can go wrong h3 Learning rate LR too low h3 Too few epochs h3 Too many epochs ", "stargazers_count": 0, "forks_count": 0, "description": "We then feed the top losses indexes and corresponding dataset to ImageCleaner. from_similars to get the potential duplicates ids and then run ImageCleaner with duplicates True. Note You can download the urls locally and upload them to kaggle using Here I have uploaded the urls for Teddy Grizzly Black Then we can remove any images that can t be opened View data Interpretation Cleaning UpSome of our top losses aren t due to bad performance by our model. widgets we can prune our top losses removing photos that don t belong. You can do this by running the following commands urls Array. Too few epochs Too many epochs. ai videos lesson 2 Lesson resources and updates https forums. Then click Next Batch to delete flagged photos and keep the rest in that row. You can test your model on CPU like so So you might create a route something like this thanks https github. query_params url img open_image BytesIO bytes _ _ losses learner. Lesson Video Link https course. Please uncomment the lines as you spot them Creating your own dataset from Google Images by Francisco Ingham and Jeremy Howard. ImageCleaner ds idxs You can also find duplicates in your dataset and delete them To do this you need to run. open data text csv charset utf 8 escape urls. predict img return JSONResponse predictions sorted zip cat_learner. All the images you scrolled past are now available to download. First we need to get the file paths from our top_losses. ai t lesson 2 chat 28722 Further discussion thread https forums. The maximum number of images Google Images shows is 700. Press CtrlShiftJ in Windows Linux and CmdOptJ in Mac and a small window the javascript Console will appear. Using the ImageCleaner widget from fastai. ai for creating these I ve merely created a mirror of the same hereFor complete info on the course visit course. To get more click on the button and continue scrolling. That is where you will paste the JavaScript commands. ai t lesson 2 official resources and updates 28630 Lesson chat https forums. Things that can go wrong Most of the time things will train fine with the defaults There s not much you really need to tune despite what you ve heard Most likely are Learning rate Number of epochs Learning rate LR too lowAs well as taking a really long time it s getting too many looks at each image so may overfit. We can do this with. com simonw cougar or not to Simon Willison for the structure of this code app. Notice that the widget will not delete images directly from disk but it will create a new csv file cleaned. csv from where you can create a new ImageDataBunch with the corrected labels to continue training your model. ai Note The nb displays an error since the num of files downloaded limit imposed by kaggle. It is a good idea to put things you want to exclude into the search query for instance if you are searching for the Eurasian wolf canis lupus lupus it might be a good idea to exclude other variants canis lupus lupus dog arctos familiaris baileyi occidentalisYou can also limit your results to show only photos by clicking on Tools and selecting Photos from the Type dropdown. ai t lesson 2 further discussion 28706 Note This is a mirror of the FastAI Lesson 2 Nb. Inspired by Adrian Rosebrock https www. Scroll down until you ve seen all the images you want to download or until you see a button that says Show more results. Download into file Now you must run some Javascript code in your browser which will save the URLs of all the images you want for you dataset. If you fork and run the nb cell by cell it should run normally you will have to uncomment each line of codeNote A few lines have been commented out since it causes Commit Errors in kaggle The steps require manual correction of data which causes the kernel to stop running automatically. Note Please Set the Number of images to a number that you d like to view ex n_imgs 100 Flag photos for deletion by clicking Delete. The more specific you are in your Google Search the better the results and the less manual pruning you will have to do. In this case the widget will show you images until there are none left from top_losses. classes map float losses key lambda p p 1 reverse True This example https www. csv to include the changes you made in your data Putting your model in production You probably want to use CPU for inference except at massive scale and you almost certainly don t need to train in real time. You can run these steps multiple times to grab different labels. Remember to recreate your ImageDataBunch from your cleaned. ImageCleaner will show you a new row of images until there are no more to show. join n Create directory and upload urls file into your server Choose an appropriate name for your labeled images. There are images in our data set that shouldn t be. If you don t have a GPU that happens automatically. Please thank the amazing team behind fast. com 2017 12 04 how to create a deep learning dataset using google images Get a list of URLs Search and scroll Go to Google Images and search for the images you are interested in. The API works in a similar way as with misclassified images just choose the ones you want to delete and click Next Batch until there are no more images left. io is for the Starlette web app toolkit. You will need to get the urls of each of the images. route classify url methods GET async def classify_url request bytes await get_bytes request. ", "id": "init27/fastai-v3-lesson-2", "size": "5944", "language": "python", "html_url": "https://www.kaggle.com/code/init27/fastai-v3-lesson-2", "git_url": "https://www.kaggle.com/code/init27/fastai-v3-lesson-2", "script": "fastai.widgets fastai.vision fastai ", "entities": "(('you', 'images'), 'com') (('I', 'course visit course'), 'ai') (('t', 'data'), 'be') (('You', 'commands urls following Array'), 'do') (('We', 'ImageCleaner'), 'feed') (('t', 'model'), 'note') (('where you', 'JavaScript commands'), 'be') (('don t', 'photos'), 'widget') (('So you', 'https github'), 'test') (('it', 'csv new file'), 'notice') (('the better results less you', 'Google Search'), 'have') (('widget', 'top_losses'), 'show') (('First we', 'top_losses'), 'need') (('Google Images', 'images'), 'show') (('you', 'Next Batch'), 'work') (('img return JSONResponse predictions', 'zip cat_learner'), 'predict') (('kernel', 'data'), 'run') (('ImageCleaner', 'images'), 'show') (('corrected labels', 'model'), 'csv') (('You', 'multiple times different labels'), 'run') (('you', 'Francisco Ingham'), 'uncomment') (('num', 'kaggle'), 'ai') (('classes', 'float losses'), 'map') (('that', 'more results'), 'scroll') (('canis lupus lupus dog arctos familiaris baileyi occidentalisYou', 'Type dropdown'), 'be') (('join n Create directory', 'labeled images'), 'choose') (('don almost certainly t', 'real time'), 'csv') (('You', 'images'), 'need') (('it', 'image'), 'train') (('javascript small Console', 'Mac'), 'appear') (('potential', 'duplicates True'), 'from_similar') (('route classify url methods', 'get_bytes request'), 'get') (('that', 'GPU'), 'have') (('data text open csv', 'escape utf 8 urls'), 'charset') (('you', 'images'), 'download') (('you', 'Delete'), 'note') (('t 2 further 28706 This', 'FastAI Lesson'), 'ai') (('you', 'this'), 'idx') ", "extra": "['test']", "label": "Perfect_files", "potential_description_queries": ["browser", "button", "case", "cell", "choose", "classify", "code", "correction", "course", "create", "csv", "data", "dataset", "def", "directly", "directory", "disk", "download", "error", "ex", "feed", "file", "find", "float", "following", "google", "grab", "idea", "image", "img", "include", "inference", "info", "instance", "io", "join", "kaggle", "kernel", "key", "labeled", "learning", "left", "lesson", "line", "list", "manual", "map", "maximum", "might", "model", "multiple", "name", "nb", "need", "new", "no", "none", "not", "num", "number", "official", "open", "out", "past", "performance", "potential", "predict", "production", "query", "remove", "rest", "return", "reverse", "row", "run", "running", "save", "scale", "search", "set", "similar", "something", "structure", "team", "test", "text", "time", "train", "training", "tune", "until", "url", "view", "visit", "web", "window", "zip"], "potential_description_queries_len": 97, "potential_script_queries": ["fastai"], "potential_script_queries_len": 1, "potential_entities_queries": ["following", "open", "text", "visit"], "potential_entities_queries_len": 4, "potential_extra_queries": [], "potential_extra_queries_len": 0, "all_components_potential_queries_len": 98}