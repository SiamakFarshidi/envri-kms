{"name": "cancer detection cnn ", "full_name": " h1 What things are included in this Kernel h1 1 h1 a Problem Statment h3 Task The problem is mainly a BINARY IMAGE CLASSIFICATION PROBLEM The Problem focuses on identifying the presence of metastases from a 96 96 digital histopathology images h3 Metric Evaluation Submissions are evaluated on area under the ROC curve between the predicted probability and the observed target h1 b Analysis of the problem Statment h2 What Exactly the problem statment conveys to us h3 1 The problem deals with the Binary Classification of the Image that has a shape of 96px 96px It involves identifying the metastases from the 96px 96px digital histapathology images h3 2 One key challenge is that the metastases can be as small as single cells in a large area of tissue h3 The Histopathological Images h3 About the Domain h3 So let us see some of the biological terminologies involved h3 1 Histopathology Histopathology is the diagnosis and study of diseases of the tissues and involves examining tissues and or cells under a microscope Histopathologists are responsible for making tissue diagnoses and helping clinicians manage a patient s care h1 h3 2 Lymphocytes Lymphocytes are white blood cells that are also one of the body s main types of immune cells They are made in the bone marrow and found in the blood and lymph tissue The immune system is a complex network of cells known as immune cells that include lymphocytes h1 h3 3 Lymph Nodes Lymph nodes are small lumps of tissue that contain white blood cells which fight infection They filter lymph fluid which is composed of fluid and waste products from your body tissues Lymph nodes also help activate your immune system if you have an infection h3 So now let us dive into the domain which involves Data Collection h4 The data that is provided to us for classification are the histopathological images These images are glass slide microscope images of lymph nodes that are stained with hematoxylin and eosin H E h4 Hematoxylin and eosin H E is the most widely used stain in histology and allows localization of nuclei and extracellular proteins Hematoxylin not a dye itself produces the blue Hematin via an oxidation reaction with nuclear histones causing nuclei to show blue h4 Typically nuclei are stained blue whereas cytoplasm and extracellular parts in various shades of pink h4 Lymph nodes are small glands that filter the fluid in the lymphatic system and they are the first place a breast cancer is likely to spread h4 Histological assessment of lymph node metastases is part of determining the stage of breast cancer in TNM classification which is a globally recognized standard for classifying the extent of spread of cancer h3 Links for Reference h1 2 Data Understanding h3 IS DATA RELEVANT TO THE PROBLEM h3 So now let us move forward to design our model h1 3 Designing the Model Coding Part h3 The model that I have choosen for this problem has been taken from Baseline Keras CNN h1 4 Validation and Analysis h3 Metrics h3 Prediction and Activation Visualizations h3 ROC and AUC h3 Confusion Matrix h1 5 Submission h1 Confusion Matrix h2 I hope that you found my notebook useful It took me 2 weeks to analyze the problem and then perform the coding So if you enjoyed the notebook please leave an upvote Thanks a lot for reading ", "stargazers_count": 0, "forks_count": 0, "description": "The Problem focuses on identifying the presence of metastases from a 96 96 digital histopathology images Metric Evaluation Submissions are evaluated on area under the ROC curve between the predicted probability and the observed target. Keras requires that the path should point to a folder containing images and not to the images themselves. The columns need to be ordered to match the output of the previous cell Get the true labels Get the predicted labels as probabilities Get the labels of the test images. test_dir test_images create test_dir create test_images inside test_dir check that the directory we created exists Transfer the test images into image_dir source path to image destination path to image copy the image from the source to the destination check that the images are now in the test_images Should now be 57458 images in the test_images folder Here we change the path to point to the test_images folder. What things are included in this Kernel Problem Statment and the Analysis of the Problem Statment Data Understanding Designing the Model Validation And Analysis Metrics Prediction and Activation Visualizations ROC AND AUC Submission 1 a. The slides are produced by routine clinical practices and a trained pathologist would examine similar images for identifying metastases. The immune system is a complex network of cells known as immune cells that include lymphocytes. So if you enjoyed the notebook please leave an upvote. Kaggle says that The original PCam dataset contains duplicate images due to its probabilistic sampling however the version presented on Kaggle does not contain duplicates. That is why we are creating a folder test_images inside another folder test_dir. Histopathologists are responsible for making tissue diagnoses and helping clinicians manage a patient s care. Lymph nodes are small glands that filter the fluid in the lymphatic system and they are the first place a breast cancer is likely to spread. One key challenge is that the metastases can be as small as single cells in a large area of tissue. Are the number of predictions correct Should be 57458. So now let us dive into the domain which involves Data Collection The data that is provided to us for classification are the histopathological images. So now let us move forward to design our model 3. It took me 2 weeks to analyze the problem and then perform the coding. com gpreda honey bee subspecies classification adjust size here draw a number of images for each location figure_cols is also the sample size Create the Train and Validation Sets concat the dataframes shuffle Now for the train test split stratify y creates a balanced validation set. We were asked to predict a probability that the image has tumor tissue get the id column Delete the test_dir directory we created to prevent a Kaggle error. tif extension therefore we add it here get the label for a certain image these must match the folder names source path to image destination path to image copy the image from the source to the destination check how many train images we have in each folder check how many val images we have in each folder Set up the generators Note shuffle False causes the test dataset to not be shuffled Get the labels that are associated with each index get the metric names so we can use evaulate_generator Here the best epoch will be used. It involves identifying the metastases from the 96px 96px digital histapathology images. Hematoxylin not a dye itself produces the blue Hematin via an oxidation reaction with nuclear histones causing nuclei to show blue. Typically nuclei are stained blue whereas cytoplasm and extracellular parts in various shades of pink. Put the predictions into a dataframe This outputs the file names in the sequence in which the generator processed the test images. The Histopathological Images About the Domain Obviously I do not know much about Biology I made some notes about the following terminologies Histopathology Lymphocytes Lymph Nodes So let us see some of the biological terminologies involved 1. Create a new directory so that we will be using the ImageDataGenerator now we create 2 folders inside base_dir train_dir a_no_tumor_tissue b_has_tumor_tissue val_dir a_no_tumor_tissue b_has_tumor_tissue create a path to base_dir to which we will join the names of the new folders train_dir val_dir CREATE FOLDERS INSIDE THE TRAIN AND VALIDATION FOLDERS Inside each folder we create seperate folders for each class create new folders inside train_dir create new folders inside val_dir check that the folders have been created Set the id as the index in df_data Get a list of train and val images Transfer the train images the id in the csv file does not have the. A positive label indicates that the center 32x32px region of a patch contains at least one pixel of tumor tissue. Hematoxylin and eosin H E is the most widely used stain in histology and allows localization of nuclei and extracellular proteins. Validation and Analysis Metrics Prediction and Activation Visualizations ROC and AUC Confusion Matrix 5. Histological assessment of lymph node metastases is part of determining the stage of breast cancer in TNM classification which is a globally recognized standard for classifying the extent of spread of cancer. Submission Confusion Matrix I hope that you found my notebook useful. These images are glass slide microscope images of lymph nodes that are stained with hematoxylin and eosin H E. Lymphocytes Lymphocytes are white blood cells that are also one of the body s main types of immune cells. Lymph Nodes Lymph nodes are small lumps of tissue that contain white blood cells which fight infection. Lymph nodes also help activate your immune system if you have an infection. Kaggle allows a max of 500 files to be saved. Also one of the hing is that the problem states that the training Data contains 50 50 Images of both the labels i. add the filenames to the dataframe Create an id column A file name now has this format test_images 00006537328c33e284c973d7b39d340809f7271b. We have otherwise maintained the same data and splits as the PCam benchmark. tif extension therefore we add it here get the label for a certain image these must match the folder names source path to image destination path to image copy the image from the source to the destination Transfer the val images the id in the csv file does not have the. Analysis of the problem Statment What Exactly the problem statment conveys to us 1. They filter lymph fluid which is composed of fluid and waste products from your body tissues. Data Understanding The dataset contains the histopathological Images each image is 96px 96px. Links for Reference What is Metastatis Hematoxylin and eosin H E Staining Lymphocytes Lymph Nodes TNM Classification 2. annot True to annotate cells labels title and ticks. Designing the Model Coding Part The model that I have choosen for this problem has been taken from Baseline Keras CNN 4. Save the last model display the loss and accuracy curves make a prediction Save the last model This is how to check what index keras has internally assigned to each class. CREATE A TEST FOLDER DIRECTORY STRUCTURE We will be feeding test images from a folder into predict_generator. tif This function will extract the id 00006537328c33e284c973d7b39d340809f7271b split into a list split into a list Get the predicted labels. Histopathology Histopathology is the diagnosis and study of diseases of the tissues and involves examining tissues and or cells under a microscope. argmax returns the index of the max value in a row Print the label associated with each class Delete base_dir and it s sub folders to free up disk space. The problem deals with the Binary Classification of the Image that has a shape of 96px 96px. the training contains equal proportion of both the labels however on analysis it was found to be nearly equal to 60 40 which we will consider while we design the model IS DATA RELEVANT TO THE PROBLEM This dataset is a combination of two independent datasets collected in Radboud University Medical Center Nijmegen the Netherlands and the University Medical Center Utrecht Utrecht the Netherlands. Problem Statment Task The problem is mainly a BINARY IMAGE CLASSIFICATION PROBLEM. This outer region is provided to enable fully convolutional models that do not use zero padding to ensure consistent behavior when applied to a whole slide image. Put the predictions into a dataframe. Tumor tissue in the outer region of the patch does not influence the label. They are made in the bone marrow and found in the blood and lymph tissue. Thanks a lot for reading Importing Libraries Setting Some Pre Requisites We will be training 80 000 samples from each label So what are the files which are available So how many images are there in each of the folder in the training dataset Creating a dataframe of all the training images removing this image because it caused a training error previously removing this image because it s black source https www. ", "id": "sloshdevelopers/cancer-detection-cnn", "size": "6222", "language": "python", "html_url": "https://www.kaggle.com/code/sloshdevelopers/cancer-detection-cnn", "git_url": "https://www.kaggle.com/code/sloshdevelopers/cancer-detection-cnn", "script": "Flatten sklearn.utils sklearn.metrics tensorflow.keras.optimizers tensorflow.keras.layers tensorflow.keras.preprocessing.image tensorflow.keras.callbacks EarlyStopping Dropout Sequential Path extract_id tensorflow.keras.models Adam numpy.random shuffle Conv2D seaborn numpy pathlib plot_confusion_matrix ReduceLROnPlateau seed ModelCheckpoint confusion_matrix ImageDataGenerator sklearn.model_selection matplotlib.pyplot Activation Dense tensorflow pandas draw_category_images MaxPooling2D roc_auc_score keras train_test_split ", "entities": "(('So now us', 'forward model'), 'let') (('that', 'classification'), 'let') (('true labels', 'test images'), 'need') (('slides', 'metastases'), 'produce') (('Typically nuclei', 'pink'), 'stain') (('which', 'infection'), 'be') (('It', 'then coding'), 'take') (('you', 'infection'), 'help') (('It', 'histapathology 96px 96px digital images'), 'involve') (('Histopathology Lymphocytes Lymph So us', '1'), 'Images') (('it', 'previously image'), 'thank') (('Here we', 'test_images folder'), 'create') (('max', '500 files'), 'allow') (('training Data', 'labels'), 'be') (('We', 'predict_generator'), 'CREATE') (('that', '96px 96px'), 'deal') (('We', 'PCam benchmark'), 'maintain') (('file name', 'test_images'), 'add') (('function', 'predicted labels'), 'extract') (('i d', 'the'), 'extension') (('image', 'histopathological Images'), 'understand') (('center 32x32px region', 'tumor tissue'), 'indicate') (('index keras', 'internally class'), 'display') (('Here best epoch', 'evaulate_generator'), 'extension') (('that', 'lymphocytes'), 'be') (('that', 'H hematoxylin E.'), 'be') (('They', 'blood tissue'), 'make') (('Histopathology Histopathology', 'microscope'), 'be') (('things', 'Metrics Visualizations AUC Model Validation Prediction 1 a.'), 'include') (('H Hematoxylin E', 'nuclei'), 'be') (('which', 'body tissues'), 'filter') (('generator', 'test images'), 'output') (('why we', 'folder test_dir'), 'be') (('path', 'images'), 'require') (('blood white that', 'immune cells'), 'be') (('metastases', 'tissue'), 'be') (('nuclei', 'blue'), 'produce') (('I', 'Baseline Keras'), 'design') (('So you', 'upvote'), 'leave') (('dataset', 'Radboud University Medical Center Nijmegen'), 'contain') (('however version', 'duplicates'), 'say') (('d test_dir we', 'Kaggle error'), 'ask') (('Problem', 'predicted probability'), 'focus') (('breast first cancer', 'lymphatic system'), 'be') (('index', 'the'), 'create') (('which', 'cancer'), 'be') (('Exactly problem', 'conveys us'), 'Statment') (('annot', 'title'), 'label') (('that', 'slide when whole image'), 'provide') (('it', 'sub disk space'), 'return') (('y', 'validation balanced set'), 'draw') (('Tumor tissue', 'label'), 'influence') (('clinicians', 'care'), 'be') ", "extra": "['biopsy of the greater curvature', 'disease', 'patient', 'test', 'diagnosis', 'lymphocyte']", "label": "Perfect_files", "potential_description_queries": ["accuracy", "adjust", "analyze", "annotate", "area", "assessment", "associated", "behavior", "best", "blood", "body", "breast", "cancer", "cell", "center", "challenge", "check", "classification", "column", "consider", "contain", "convolutional", "copy", "correct", "create", "csv", "curve", "cytoplasm", "data", "dataframe", "dataset", "diagnosis", "directory", "disk", "display", "domain", "draw", "duplicate", "enable", "ensure", "epoch", "equal", "error", "evaulate_generator", "extension", "extent", "extract", "file", "filter", "folder", "following", "format", "forward", "found", "function", "generator", "help", "hope", "id", "image", "immune", "include", "index", "influence", "itself", "join", "key", "label", "least", "leave", "let", "list", "lot", "main", "manage", "match", "max", "metric", "microscope", "model", "most", "move", "my", "name", "need", "network", "new", "node", "not", "notebook", "nuclei", "number", "ordered", "outer", "output", "padding", "part", "patch", "path", "pathologist", "patient", "perform", "pixel", "place", "point", "positive", "predict", "prediction", "prevent", "probability", "problem", "reading", "region", "routine", "row", "sample", "sampling", "sequence", "shape", "shuffle", "similar", "single", "size", "slide", "source", "split", "spread", "stage", "stain", "standard", "sub", "system", "test", "tif", "tissue", "title", "train", "training", "tumor", "under", "up", "val", "validation", "value", "version", "while"], "potential_description_queries_len": 146, "potential_script_queries": ["numpy", "pathlib", "preprocessing", "seaborn", "tensorflow"], "potential_script_queries_len": 5, "potential_entities_queries": ["disk"], "potential_entities_queries_len": 1, "potential_extra_queries": ["biopsy", "lymphocyte"], "potential_extra_queries_len": 2, "all_components_potential_queries_len": 152}