{"name": "molecular geometry feature engineering eda ", "full_name": " h1 Molecular Geometry Feature Engineering h1 Feature Evaluation h1 EDA h2 Flatness Metric h2 Bond Angle with Molecule Plane h2 Bond Angle with Molecule Principle Axis ", "stargazers_count": 0, "forks_count": 0, "description": "Bond Angle with Molecule Principle AxisAgain a mixed bag with a few areas that might benefit histogram splitting algorithms like LightGBM. You may want to experiment and use a threshold of molecular flatness above which angle measurements are discarded. Feature EvaluationNow we can examine some of the results. PCA has in this case identifed one of two lines that could be thought of as the principal axis and the method will have to be refined. There are undoubtedly many ways this approach can be extended with some more specific feature engineering but this kernel will hopefully be a useful primer to get you started. This molecule has a complex shape that cannot easily be mapped to a 2D plane. Will this affect its coupling constant relative to other H H bonds Let s look at an atom with a small angle between its 2D plane and one of its bonds. This kernel uses Singular Value Decomposition SVD to calculate the 2D plane of best fit for all molecules containing 4 or more atoms and then calculates both the mean normalised distance of all atoms from this plane to provide a measure of flatness for the molecule. 2JHH bonds for example show their lowest values with low bond axis angle values. This molecule which looks suspiciously like a poodle is flat along the axis of its larger atoms there s an idea for further feature engineering but one of the hydrogen hydrogen bonds is orthogonal to this. Most of the hydrogen hydrogen bonds in this molecule lie orthogonal to the principal axis. jpg Molecular Geometry Feature Engineering The shape of molecules is principally related to the quantum mechanical properties of electron interactions. Electron interaction also mediates the strength of the nuclear coupling constant between bound atoms so features derived from their 3D distribution may prove useful. Recall that the higher this metric the less flat a molecule is. Let s try one with a very low flatness metric. This molecule fits perfectly onto a 2D plane. Let s examine a molecule where the reverse is true. The angles subtended by this plane and the atomic bonds in the molecule are then calculated. EDA Flatness MetricThe flatness metric in isolation clearly isn t a strong feature and could probably be improved by removing hydrogen bonds from its calculation. This is a very flat molecule and all its atomic bonds lie on its principal axis. Again molecules without a clear orientation may yield arbitrary results however this kernel contains plenty of ideas to get you started. These features take a long time to process around 12 hours in total. Some caution should be used with the latter feature. Let s examine a bond with a high angle between itself and the plane of best fit. Good luck in the competition Select a molecule Get atomic coordinates Get atomic symbols Display molecule quick PCA via singular value decomp obtain principal eigenvector of molecule axis obtain plane with minimum sum distance from nuclei obtain structure and bond information for each molecule number of constituent atoms nuclei coords principal axis of molecular alignment obtain flatness metric and plane angles for binds if nuclei 3 calculate best fitting 2D plane calculate distances of each atom from plane append mean distance to molecule list obtain angle subtended by each atomic bind and plane obtain atom index numbers for this bond get 3D coords bond vector angle subtended by bond vector and molecule plane standardise to degrees 90 not needed but somewhat easier to visualise for smaller molecules flatness and plane angle measurements are not informative obtain atom index numbers for this bond get 3D coords bond vector angle subtended by bond vector and molecule principal axis standardise to degrees 90 not needed but somewhat easier to visualise. This can be done with molecules of at least 3 atoms. I m putting the finished file into a dataset so check in the comments section for a link if you don t want to engineer them yourself. Bond Angle with Molecule PlaneThese features look a lot stronger. The hydrogen nitrogen bond in this molecule lies almost exactly on the principal axis. com borisdee how to easy visualization of molecules to show some feature examples. Molecules comprising 3 atoms or fewer are always flat so this measure is not informative for them I have filled in these values with np. There are some aspects that might be useful for example 2JHH and 1JHC bonds with a low flatness metric don t display high scalar coupling constants. This kernel also performs a simple PCA with SVD to extract the principal axis of each molecule along with the angle subtended by each bond with it. com uploads photos 2013_web_banners5. Let s start with a molecule that has a high flatness metric. 1JHC 2JHN and 3JHN bonds clearly show useful trends. Now let s look at a molecule with a high angle between one of its bonds and its principal 1D axis. This is the weakest feature so far and I ll be working on improving it. I have calculated flatness in such a way that 0 represents a totally flat molecule. I ll be using the visualisation library demonstrated in this excellent kernel https www. Molecules without a clear 2D plane of best fit tetrahedral structures like methane for example may yield angle measurements that are not informative. If I m not mistaken it looks like it belongs to the acetylene family. ", "id": "bigironsphere/molecular-geometry-feature-engineering-eda", "size": "4405", "language": "python", "html_url": "https://www.kaggle.com/code/bigironsphere/molecular-geometry-feature-engineering-eda", "git_url": "https://www.kaggle.com/code/bigironsphere/molecular-geometry-feature-engineering-eda", "script": "ase PCA_SVD get_plane numpy tqdm_notebook as tqdm matplotlib.pyplot Atoms pandas tqdm_notebook numpy.linalg svd view tqdm ", "entities": "(('you', 'ideas'), 'yield') (('jpg Molecular Geometry Feature shape', 'electron interactions'), 'Engineering') (('I', 'np'), 'be') (('kernel', 'molecule'), 'use') (('suspiciously poodle', 'this'), 'be') (('weakest so far I', 'it'), 'be') (('Most', 'principal axis'), 'lie') (('s', 'very low flatness metric'), 'let') (('This', 'at least 3 atoms'), 'do') (('features', 'total'), 'take') (('kernel', 'it'), 'perform') (('that', 'high scalar coupling constants'), 'be') (('0', 'totally flat molecule'), 'calculate') (('I', 'kernel https excellent www'), 'use') (('Feature EvaluationNow we', 'results'), 'examine') (('that', 'high flatness metric'), 'let') (('that', '2D easily plane'), 'have') (('atomic bonds', 'molecule'), 'calculate') (('Bond Angle', 'Molecule PlaneThese features'), 'look') (('molecule', '2D perfectly plane'), 'fit') (('it', 'acetylene family'), 'look') (('s', 'best fit'), 'let') (('so features', '3D distribution'), 'mediate') (('that', 'algorithms'), 'bag') (('angle measurements', 'which'), 'want') (('method', 'principal axis'), 'identife') (('2JHH bonds', 'bond angle low axis values'), 'show') (('where reverse', 'molecule'), 'let') (('caution', 'latter feature'), 'use') (('hopefully useful you', 'feature more specific engineering'), 'be') (('you', 'don them'), 'put') (('s', 'bonds'), 'affect') (('Now s', 'bonds'), 'let') (('very flat atomic bonds', 'principal axis'), 'be') (('that', 'angle measurements'), 'yield') (('3JHN bonds', 'clearly useful trends'), 'show') (('hydrogen nitrogen bond', 'almost exactly principal axis'), 'lie') (('coords bond vector 3D angle', 'principal degrees'), 'select') ", "extra": "['biopsy of the greater curvature', 'bag']", "label": "Perfect_files", "potential_description_queries": ["alignment", "append", "approach", "atom", "bag", "best", "calculate", "case", "check", "clear", "competition", "could", "dataset", "display", "distance", "distribution", "engineering", "experiment", "extract", "feature", "file", "fit", "fitting", "flat", "high", "histogram", "idea", "index", "itself", "kernel", "latter", "least", "let", "library", "link", "list", "look", "lot", "mean", "measure", "method", "metric", "might", "minimum", "mixed", "molecule", "not", "nuclei", "number", "orientation", "plane", "principal", "provide", "relative", "reverse", "section", "shape", "splitting", "start", "strength", "structure", "sum", "thought", "threshold", "time", "try", "value", "vector", "visualise", "visualization"], "potential_description_queries_len": 70, "potential_script_queries": ["ase", "numpy", "tqdm", "view"], "potential_script_queries_len": 4, "potential_entities_queries": ["least", "vector"], "potential_entities_queries_len": 2, "potential_extra_queries": ["biopsy of the greater curvature", "biopsy"], "potential_extra_queries_len": 2, "all_components_potential_queries_len": 75}